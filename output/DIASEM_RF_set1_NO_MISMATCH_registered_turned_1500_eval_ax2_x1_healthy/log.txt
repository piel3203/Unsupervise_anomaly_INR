Evaluating model 'DIASEM_RF_set1_NO_MISMATCH_registered_turned'.
Reconstructing from slices with step size 1 along axis 2.
Loading test data into memory...
FD121_RF
Initial spacing: [0.17 0.17 0.17]
New spacing: [1.70000002 1.70000002 1.70000002]
RESAMPLED VOL SHAPE: (65, 66, 228)
GD123_RF
Initial spacing: [0.16 0.16 0.16]
New spacing: [1.59999996 1.59999996 1.59999996]
RESAMPLED VOL SHAPE: (64, 65, 219)
IJ157_RF
Initial spacing: [0.19 0.19 0.19]
New spacing: [1.89999998 1.89999998 1.89999998]
RESAMPLED VOL SHAPE: (73, 75, 183)
LE120_RF
Initial spacing: [0.17 0.17 0.17]
New spacing: [1.70000002 1.70000002 1.70000002]
RESAMPLED VOL SHAPE: (74, 59, 217)
PJ165_RF
Initial spacing: [0.17 0.17 0.17]
New spacing: [1.70000002 1.70000002 1.70000002]
RESAMPLED VOL SHAPE: (70, 69, 213)
RA126_RF
Initial spacing: [0.19 0.19 0.19]
New spacing: [1.89999998 1.89999998 1.89999998]
RESAMPLED VOL SHAPE: (106, 54, 178)
RY166_RF
Initial spacing: [0.17 0.17 0.17]
New spacing: [1.70000002 1.70000002 1.70000002]
RESAMPLED VOL SHAPE: (75, 63, 204)
sujet12_RF_faible
Initial spacing: [0.17 0.17 0.17]
New spacing: [1.70000002 1.70000002 1.70000002]
RESAMPLED VOL SHAPE: (63, 69, 211)
sujet12_RF_fort
Initial spacing: [0.16 0.16 0.16]
New spacing: [1.59999996 1.59999996 1.59999996]
RESAMPLED VOL SHAPE: (70, 66, 223)
sujet12_RF_pad
Initial spacing: [0.18000001 0.18000001 0.18000001]
New spacing: [1.80000007 1.80000007 1.80000007]
RESAMPLED VOL SHAPE: (66, 73, 205)
sujet4_RF_faible
Initial spacing: [0.17 0.17 0.17]
New spacing: [1.70000002 1.70000002 1.70000002]
RESAMPLED VOL SHAPE: (64, 69, 213)
sujet4_RF_fort
Initial spacing: [0.15000001 0.15000001 0.15000001]
New spacing: [1.50000006 1.50000006 1.50000006]
RESAMPLED VOL SHAPE: (75, 64, 213)
sujet4_RF_pad
Initial spacing: [0.19 0.19 0.19]
New spacing: [1.89999998 1.89999998 1.89999998]
RESAMPLED VOL SHAPE: (75, 64, 197)
sujet9_RF_faible
Initial spacing: [0.18000001 0.18000001 0.18000001]
New spacing: [1.80000007 1.80000007 1.80000007]
RESAMPLED VOL SHAPE: (68, 63, 215)
sujet9_RF_fort
Initial spacing: [0.17 0.17 0.17]
New spacing: [1.70000002 1.70000002 1.70000002]
RESAMPLED VOL SHAPE: (65, 63, 232)
sujet9_RF_pad
Initial spacing: [0.19 0.19 0.19]
New spacing: [1.89999998 1.89999998 1.89999998]
RESAMPLED VOL SHAPE: (72, 70, 207)
SPACINGS: [tensor([1.7002, 1.7002, 1.7002], dtype=torch.float16), tensor([1.5996, 1.5996, 1.5996], dtype=torch.float16), tensor([1.9004, 1.9004, 1.9004], dtype=torch.float16), tensor([1.7002, 1.7002, 1.7002], dtype=torch.float16), tensor([1.7002, 1.7002, 1.7002], dtype=torch.float16), tensor([1.9004, 1.9004, 1.9004], dtype=torch.float16), tensor([1.7002, 1.7002, 1.7002], dtype=torch.float16), tensor([1.7002, 1.7002, 1.7002], dtype=torch.float16), tensor([1.5996, 1.5996, 1.5996], dtype=torch.float16), tensor([1.7998, 1.7998, 1.7998], dtype=torch.float16), tensor([1.7002, 1.7002, 1.7002], dtype=torch.float16), tensor([1.5000, 1.5000, 1.5000], dtype=torch.float16), tensor([1.9004, 1.9004, 1.9004], dtype=torch.float16), tensor([1.7998, 1.7998, 1.7998], dtype=torch.float16), tensor([1.7002, 1.7002, 1.7002], dtype=torch.float16), tensor([1.9004, 1.9004, 1.9004], dtype=torch.float16)]
Volume size: tensor([201.5000, 142.5000, 394.5000], dtype=torch.float16).
Loading test data done (16 images): 376.22s
Loading state file: models/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned/checkpoint_160000.pth
Train latents avg length squared: 29.634469985961914
[373.0, 324.0, 1103.5]
Batch 1/16
Batch cases: ['FD121_RF']
Step 0100/1500: loss 0.1306 DSC 0.898 L2^2(z): 12.92 (11.9s)
Step 0200/1500: loss 0.0964 DSC 0.924 L2^2(z): 17.40 (10.9s)
Step 0300/1500: loss 0.0875 DSC 0.931 L2^2(z): 20.94 (10.9s)
Step 0400/1500: loss 0.0821 DSC 0.936 L2^2(z): 24.57 (10.9s)
Step 0500/1500: loss 0.0783 DSC 0.939 L2^2(z): 27.99 (10.9s)
Step 0600/1500: loss 0.0752 DSC 0.942 L2^2(z): 31.67 (10.9s)
Step 0700/1500: loss 0.0732 DSC 0.944 L2^2(z): 34.86 (10.9s)
Step 0800/1500: loss 0.0719 DSC 0.945 L2^2(z): 37.25 (11.0s)
Step 0900/1500: loss 0.0708 DSC 0.946 L2^2(z): 39.16 (11.0s)
Step 1000/1500: loss 0.0698 DSC 0.947 L2^2(z): 40.89 (11.0s)
Step 1100/1500: loss 0.0685 DSC 0.948 L2^2(z): 43.37 (11.0s)
Step 1200/1500: loss 0.0671 DSC 0.950 L2^2(z): 46.50 (11.0s)
Step 1300/1500: loss 0.0662 DSC 0.951 L2^2(z): 49.45 (11.0s)
Step 1400/1500: loss 0.0655 DSC 0.952 L2^2(z): 51.65 (11.0s)
Step 1500/1500: loss 0.0650 DSC 0.952 L2^2(z): 53.13 (11.0s)
L2^2(z): 53.1338
z: Parameter containing:
tensor([[ 0.9317,  0.5596, -0.9209,  0.4911,  0.5889,  0.0556,  0.2731, -0.5700,
          1.0036,  0.2052,  0.1069, -0.5664,  0.7626,  0.3743, -1.1240,  0.1518,
         -0.1257,  0.9334,  0.3624,  0.0733,  0.9096, -0.2772, -0.6409, -0.5656,
         -0.6062,  1.0665, -0.2158, -0.4701,  0.2030, -1.5989,  0.9273,  0.1563,
          0.2101, -0.1749, -0.5106,  0.5264,  0.0174,  0.0919, -0.0986,  0.6463,
         -0.4191,  1.0118, -0.8926,  0.0142, -0.5428, -0.5746,  0.4794, -0.3247,
         -0.9449, -0.4193,  0.2279, -0.7860, -0.1652,  0.1129, -0.2214, -0.1827,
          1.2148,  0.5848,  0.0838,  0.2778, -0.5254, -0.3657,  0.0537,  0.1489,
         -1.4724, -0.8431,  1.1692, -0.1229, -0.0895,  0.4377,  0.8329, -0.2121,
         -1.1933,  0.0069,  0.5916, -0.7090, -0.2764,  0.6952, -0.1626, -0.1258,
          0.6053,  0.3167, -1.5524, -0.6521, -0.0158, -0.8371, -0.3460,  0.4487,
          0.3140, -0.3895,  0.1552,  0.7407, -0.3956, -0.6125,  0.0915, -1.2770,
          0.6189, -0.6550,  0.4239,  0.4593, -0.1456,  0.7059, -1.3056,  1.0943,
         -0.9765, -0.2917, -0.3801, -0.3971, -0.1889, -0.6457,  0.1508, -1.1049,
          1.0824,  0.2050, -1.5443,  0.0373, -0.4084, -0.9352,  0.3122, -0.3312,
         -0.2254, -0.5337,  0.2842,  0.3134,  0.3281, -0.9017,  0.7673, -0.8243]],
       device='cuda:0', requires_grad=True)
tensor([ 65,  66, 228])
tensor([ 65,  66, 228])
Batch prediction time: 165.1s
labels_pred_cpu SHAPE (1, 1, 65, 66, 228)
labels_gt_cpu SHAPE (1, 1, 65, 66, 228)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 0.25061718749999784, Volume error (%): 0.23917835201425486
Eccentricity (pred): 0.9858569374456865, Eccentricity (GT): 0.9858513698985448
Curvature (pred): 4.99891228840981, Curvature (GT): 4.877578249405136
Batch ASD: 0.3026, HSD: 8.8345, HSD95: 1.7002, DSC: 0.9523, err_vol_cm_3: 0.2506, err_vol_percent: 0.2392, Eccentricity (pred): 0.9859, Eccentricity (GT): 0.9859, Curvature (pred): 4.9989, Curvature (GT): 4.8776
Shape of labels_lr: torch.Size([1, 65, 66, 228])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 64,  65, 225],
        [ 64,  65, 226],
        [ 64,  65, 227]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 2/16
Batch cases: ['GD123_RF']
Step 0100/1500: loss 0.1133 DSC 0.907 L2^2(z): 12.10 (10.2s)
Step 0200/1500: loss 0.0975 DSC 0.920 L2^2(z): 14.11 (10.2s)
Step 0300/1500: loss 0.0857 DSC 0.930 L2^2(z): 17.98 (10.2s)
Step 0400/1500: loss 0.0807 DSC 0.936 L2^2(z): 21.55 (10.2s)
Step 0500/1500: loss 0.0780 DSC 0.939 L2^2(z): 24.20 (10.2s)
Step 0600/1500: loss 0.0761 DSC 0.940 L2^2(z): 26.81 (10.2s)
Step 0700/1500: loss 0.0744 DSC 0.942 L2^2(z): 29.55 (10.2s)
Step 0800/1500: loss 0.0728 DSC 0.944 L2^2(z): 32.04 (10.3s)
Step 0900/1500: loss 0.0717 DSC 0.946 L2^2(z): 34.34 (10.3s)
Step 1000/1500: loss 0.0709 DSC 0.947 L2^2(z): 36.50 (10.3s)
Step 1100/1500: loss 0.0702 DSC 0.947 L2^2(z): 38.50 (10.3s)
Step 1200/1500: loss 0.0698 DSC 0.948 L2^2(z): 40.02 (10.2s)
Step 1300/1500: loss 0.0695 DSC 0.948 L2^2(z): 41.24 (10.2s)
Step 1400/1500: loss 0.0692 DSC 0.949 L2^2(z): 42.59 (10.2s)
Step 1500/1500: loss 0.0687 DSC 0.949 L2^2(z): 44.09 (10.2s)
L2^2(z): 44.0906
z: Parameter containing:
tensor([[-0.9311,  0.2751, -0.5044,  0.2309, -0.2644, -0.4594,  0.3000,  0.5237,
          0.6553, -0.4472,  0.7115, -1.0357, -0.4868,  0.7888, -1.7952,  0.5907,
         -0.4601,  1.5407, -0.6628, -0.0931,  0.2518,  0.0467,  0.2592, -0.2723,
          0.2604, -1.1059,  0.6007, -0.1322,  0.6457, -0.4889,  0.2698, -1.0724,
          0.1261, -0.8552,  0.0414, -0.4870, -0.0334, -0.5242,  0.2837,  0.3271,
         -0.0301,  0.5671, -0.0056, -0.1820, -0.0675, -0.3166,  0.4291, -0.1427,
         -0.4944,  0.8808,  0.3171, -0.2434, -0.6614, -0.7227,  0.0890,  0.3282,
         -0.8777, -0.2307,  0.4030,  1.6569,  0.2208,  0.5063, -0.3786,  0.6321,
         -0.3356, -0.8502,  0.3884, -0.5016, -0.0462, -0.3823,  1.5847, -0.0233,
          0.7006, -0.0043,  0.2896,  0.4100, -1.0749, -0.7296, -0.3155, -0.4999,
         -0.3524, -0.7006, -1.1675, -0.1885,  0.0782, -0.1182, -0.1390, -0.2432,
          0.0444, -0.3787, -0.4436, -0.1579, -0.4349, -0.6884,  0.3142, -0.3326,
          0.4386,  0.1234, -0.0282, -0.4299,  1.6459,  0.4444, -0.3936,  0.2849,
         -0.1951, -0.7286, -0.3758, -0.4214, -0.6323, -0.4528,  0.0385, -0.8645,
         -1.1064,  0.2073,  0.2411, -0.1828,  0.3654,  0.6300,  1.0687, -0.5243,
          0.5513,  0.2836,  0.1188, -0.1350, -0.3142, -0.3795,  0.0370, -0.2113]],
       device='cuda:0', requires_grad=True)
tensor([ 64,  65, 219])
tensor([ 64,  65, 219])
Batch prediction time: 153.8s
labels_pred_cpu SHAPE (1, 1, 64, 65, 219)
labels_gt_cpu SHAPE (1, 1, 64, 65, 219)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 0.1883125000000092, Volume error (%): 0.2465298247494627
Eccentricity (pred): 0.9877417479929991, Eccentricity (GT): 0.9871441536261243
Curvature (pred): 4.905767322760103, Curvature (GT): 4.833378780026132
Batch ASD: 0.2603, HSD: 4.7988, HSD95: 1.5996, DSC: 0.9493, err_vol_cm_3: 0.1883, err_vol_percent: 0.2465, Eccentricity (pred): 0.9877, Eccentricity (GT): 0.9871, Curvature (pred): 4.9058, Curvature (GT): 4.8334
Shape of labels_lr: torch.Size([1, 64, 65, 219])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 63,  64, 216],
        [ 63,  64, 217],
        [ 63,  64, 218]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 3/16
Batch cases: ['IJ157_RF']
Step 0100/1500: loss 0.1722 DSC 0.854 L2^2(z): 13.50 (11.2s)
Step 0200/1500: loss 0.1447 DSC 0.877 L2^2(z): 19.37 (11.2s)
Step 0300/1500: loss 0.1313 DSC 0.889 L2^2(z): 25.67 (11.2s)
Step 0400/1500: loss 0.1227 DSC 0.897 L2^2(z): 31.62 (11.2s)
Step 0500/1500: loss 0.1155 DSC 0.904 L2^2(z): 37.86 (11.2s)
Step 0600/1500: loss 0.1103 DSC 0.909 L2^2(z): 43.92 (11.2s)
Step 0700/1500: loss 0.1064 DSC 0.913 L2^2(z): 50.47 (11.2s)
Step 0800/1500: loss 0.1037 DSC 0.916 L2^2(z): 55.32 (11.2s)
Step 0900/1500: loss 0.1021 DSC 0.918 L2^2(z): 59.87 (11.2s)
Step 1000/1500: loss 0.1007 DSC 0.919 L2^2(z): 64.31 (11.2s)
Step 1100/1500: loss 0.0993 DSC 0.921 L2^2(z): 69.69 (11.2s)
Step 1200/1500: loss 0.0984 DSC 0.923 L2^2(z): 75.01 (11.2s)
Step 1300/1500: loss 0.0977 DSC 0.924 L2^2(z): 79.24 (11.2s)
Step 1400/1500: loss 0.0971 DSC 0.924 L2^2(z): 82.27 (11.2s)
Step 1500/1500: loss 0.0965 DSC 0.926 L2^2(z): 84.93 (11.2s)
L2^2(z): 84.9322
z: Parameter containing:
tensor([[ 0.5412,  0.1482, -0.1365,  0.6517, -0.6605, -1.1165,  1.1246,  0.2800,
         -0.2696,  0.2314,  0.9817, -0.3903,  0.6022, -0.1455, -0.0717,  0.8926,
          0.4640,  0.7767, -0.4252,  0.4791, -0.1568, -0.2470,  0.4489,  0.0780,
         -0.4866,  0.0886, -0.8552,  1.9903,  1.7502,  0.0679, -0.1126,  0.2902,
         -0.8623, -1.2780,  0.8795,  0.1887, -0.9894, -0.2782, -0.6034,  0.6563,
         -1.4196,  1.1297, -0.5634, -0.4422, -0.7655, -0.0101,  1.4202, -0.9709,
         -0.3537, -0.6167, -0.4805, -0.1707,  0.5828, -0.2032, -1.2419,  0.1354,
         -1.3301,  1.1637, -1.1627, -0.3085,  0.9445,  0.2115, -0.4646,  0.2192,
         -2.1529, -0.6931, -0.3116,  0.0049,  0.8762,  1.2745,  1.6436, -1.1836,
         -0.7946,  0.1665, -0.9970, -0.0693, -1.4815,  1.0796, -0.4935, -0.9072,
          0.1069,  0.6087, -1.7267, -0.2298, -0.3330, -0.1306,  0.2410,  0.0385,
          1.3051,  0.0400, -1.0091, -0.2983, -1.7484, -1.2704,  1.3011,  0.3119,
          1.0165, -0.1387, -0.4604,  1.1066,  0.8921,  0.1356,  1.7805, -0.9371,
         -0.7158,  0.4313, -0.8007, -0.4163,  0.6819, -0.7013, -0.3529, -0.5858,
          0.7440,  0.0123, -0.9976,  0.4949, -0.7219,  0.6683,  0.9224, -0.6349,
         -0.8328,  0.0231,  0.1452, -1.3071,  0.8988,  0.0562, -0.0306, -0.1478]],
       device='cuda:0', requires_grad=True)
tensor([ 73,  75, 183])
tensor([ 73,  75, 183])
Batch prediction time: 168.5s
labels_pred_cpu SHAPE (1, 1, 73, 75, 183)
labels_gt_cpu SHAPE (1, 1, 73, 75, 183)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 0.6039687499999928, Volume error (%): 0.7205436829607709
Eccentricity (pred): 0.9817390693663214, Eccentricity (GT): 0.9814377207229333
Curvature (pred): 4.961545698535538, Curvature (GT): 4.866746020077947
Batch ASD: 0.4125, HSD: 6.3029, HSD95: 1.9004, DSC: 0.9256, err_vol_cm_3: 0.6040, err_vol_percent: 0.7205, Eccentricity (pred): 0.9817, Eccentricity (GT): 0.9814, Curvature (pred): 4.9615, Curvature (GT): 4.8667
Shape of labels_lr: torch.Size([1, 73, 75, 183])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 72,  74, 180],
        [ 72,  74, 181],
        [ 72,  74, 182]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 4/16
Batch cases: ['LE120_RF']
Step 0100/1500: loss 0.2266 DSC 0.844 L2^2(z): 14.84 (10.7s)
Step 0200/1500: loss 0.1672 DSC 0.881 L2^2(z): 26.17 (10.7s)
Step 0300/1500: loss 0.1432 DSC 0.897 L2^2(z): 38.92 (10.7s)
Step 0400/1500: loss 0.1315 DSC 0.905 L2^2(z): 50.27 (10.7s)
Step 0500/1500: loss 0.1246 DSC 0.910 L2^2(z): 59.38 (10.7s)
Step 0600/1500: loss 0.1210 DSC 0.914 L2^2(z): 65.71 (10.7s)
Step 0700/1500: loss 0.1186 DSC 0.916 L2^2(z): 70.70 (10.7s)
Step 0800/1500: loss 0.1163 DSC 0.917 L2^2(z): 75.86 (10.7s)
Step 0900/1500: loss 0.1143 DSC 0.919 L2^2(z): 80.99 (10.7s)
Step 1000/1500: loss 0.1126 DSC 0.921 L2^2(z): 85.78 (10.7s)
Step 1100/1500: loss 0.1111 DSC 0.923 L2^2(z): 89.42 (10.7s)
Step 1200/1500: loss 0.1098 DSC 0.924 L2^2(z): 92.62 (10.7s)
Step 1300/1500: loss 0.1083 DSC 0.925 L2^2(z): 96.37 (10.7s)
Step 1400/1500: loss 0.1067 DSC 0.927 L2^2(z): 100.46 (10.7s)
Step 1500/1500: loss 0.1055 DSC 0.928 L2^2(z): 104.41 (10.7s)
L2^2(z): 104.4096
z: Parameter containing:
tensor([[-0.4914, -0.1469,  0.7547, -1.5753,  0.7896,  2.3131,  0.3193,  0.0362,
          0.9820, -1.1217, -0.5945,  0.5000, -0.7495,  0.0828,  0.0781,  0.6686,
          1.8210, -0.6335, -0.0231,  0.0185,  0.7468,  0.0106, -1.6846,  0.0094,
         -1.0812, -0.4613, -2.2689,  0.9851,  0.4032, -0.1831, -0.2544, -0.4571,
          0.6283,  0.9176,  0.4212,  1.1546, -1.2095, -0.0813,  0.1807,  1.4646,
          0.6432,  0.6819,  1.1112, -0.8327, -0.3859, -1.3650,  1.3103, -1.3948,
         -0.0830,  0.3590, -0.0670, -1.9020, -0.3099, -0.7014,  0.0934,  0.4718,
          1.0047, -0.3205, -1.2732,  0.6229, -0.9757,  0.4111, -0.2624,  0.4152,
          0.0160, -0.2206, -0.6680, -1.6195, -0.3303, -1.6051,  2.0899, -1.2920,
         -1.0912,  0.4617, -0.0636,  0.4959, -0.0367, -1.0072, -0.9289, -1.2558,
         -1.5317,  0.3904,  1.7310,  0.2450,  0.5195, -0.6800,  0.0482, -0.1670,
          1.4509, -1.0285, -0.0532,  0.8542, -0.6563, -0.6718,  1.2677,  0.1242,
          1.0754, -0.1200,  0.6398, -0.4134,  0.2804,  0.2002, -0.6144,  0.6342,
          0.3195, -0.1632,  0.3130, -0.4827, -1.2517, -1.5654,  0.6242,  1.0245,
          0.9362,  1.2304,  1.6487, -0.9211, -1.9270,  0.9459,  0.2365, -0.5210,
          0.3103, -1.3885,  0.5438, -0.1538,  0.4989,  0.1274, -0.6393,  0.0831]],
       device='cuda:0', requires_grad=True)
tensor([ 74,  59, 217])
tensor([ 74,  59, 217])
Batch prediction time: 159.9s
labels_pred_cpu SHAPE (1, 1, 74, 59, 217)
labels_gt_cpu SHAPE (1, 1, 74, 59, 217)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 0.3046718749999968, Volume error (%): 0.21479300190541956
Eccentricity (pred): 0.9732875594831293, Eccentricity (GT): 0.9721667849459205
Curvature (pred): 4.883905615347833, Curvature (GT): 4.778210134308116
Batch ASD: 0.4969, HSD: 8.6693, HSD95: 1.7002, DSC: 0.9284, err_vol_cm_3: 0.3047, err_vol_percent: 0.2148, Eccentricity (pred): 0.9733, Eccentricity (GT): 0.9722, Curvature (pred): 4.8839, Curvature (GT): 4.7782
Shape of labels_lr: torch.Size([1, 74, 59, 217])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 73,  58, 214],
        [ 73,  58, 215],
        [ 73,  58, 216]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 5/16
Batch cases: ['PJ165_RF']
Step 0100/1500: loss 0.2046 DSC 0.831 L2^2(z): 21.47 (11.5s)
Step 0200/1500: loss 0.1435 DSC 0.882 L2^2(z): 32.08 (11.5s)
Step 0300/1500: loss 0.1241 DSC 0.897 L2^2(z): 41.11 (11.5s)
Step 0400/1500: loss 0.1130 DSC 0.908 L2^2(z): 47.86 (11.5s)
Step 0500/1500: loss 0.1082 DSC 0.912 L2^2(z): 52.57 (11.5s)
Step 0600/1500: loss 0.1047 DSC 0.916 L2^2(z): 56.51 (11.5s)
Step 0700/1500: loss 0.1014 DSC 0.919 L2^2(z): 60.10 (11.5s)
Step 0800/1500: loss 0.0990 DSC 0.922 L2^2(z): 64.01 (11.5s)
Step 0900/1500: loss 0.0973 DSC 0.924 L2^2(z): 67.40 (11.5s)
Step 1000/1500: loss 0.0962 DSC 0.925 L2^2(z): 70.44 (11.5s)
Step 1100/1500: loss 0.0952 DSC 0.926 L2^2(z): 73.72 (11.5s)
Step 1200/1500: loss 0.0943 DSC 0.928 L2^2(z): 77.01 (11.5s)
Step 1300/1500: loss 0.0933 DSC 0.928 L2^2(z): 80.69 (11.5s)
Step 1400/1500: loss 0.0917 DSC 0.930 L2^2(z): 85.26 (11.5s)
Step 1500/1500: loss 0.0905 DSC 0.931 L2^2(z): 89.74 (11.5s)
L2^2(z): 89.7438
z: Parameter containing:
tensor([[ 1.1387, -0.3197,  0.1330,  0.0666, -0.0215, -0.9498,  0.8815, -0.2317,
          0.0676, -0.7227, -0.3844,  0.0400,  1.3801,  0.0392, -0.1677,  0.3292,
          0.1923, -0.7282, -0.2836, -0.5827, -0.7893,  0.4673, -0.2540,  0.0943,
          0.4257,  0.1824,  1.6544, -0.3317,  0.8521,  0.0673,  1.3703,  0.6805,
          0.1943,  1.2164,  0.3283,  0.2811, -0.8152,  0.7953,  0.4997,  1.2455,
          1.5162,  0.8775, -0.0697, -0.7303,  1.8197, -0.2911,  0.0890, -1.8055,
         -1.2669,  1.9087, -0.5051, -0.9389, -0.5088,  0.4522,  0.5889, -0.5308,
         -1.3088,  0.0431, -1.9326, -1.8038,  0.8798,  1.1083, -1.1654, -0.4120,
          0.1555, -1.5992, -0.0051, -0.4837, -0.3703, -1.2300,  0.6370, -0.6793,
          0.9405,  1.1268, -0.3609,  0.6959, -0.8779, -0.0091, -0.7869,  0.3450,
         -0.0346, -1.2722, -0.9101, -0.1252, -2.1829, -0.7637, -0.3530, -0.6430,
         -0.2630,  0.5192, -0.8044,  0.3602, -1.1061,  1.4599,  0.7524,  0.1612,
          1.3906, -0.7320,  1.2388,  0.3159, -0.3924, -0.3773,  0.0789, -0.6894,
         -0.1500, -0.4855,  0.2178, -0.2531, -0.3690,  1.5163,  0.1046, -0.0788,
         -0.3112, -0.6357,  0.2371, -0.2120, -0.0667, -1.0080, -0.2050, -0.4443,
          0.7796,  0.4238,  0.6327,  1.3947,  0.3097,  1.7295,  0.9144,  1.1863]],
       device='cuda:0', requires_grad=True)
tensor([ 70,  69, 213])
tensor([ 70,  69, 213])
Batch prediction time: 173.1s
labels_pred_cpu SHAPE (1, 1, 70, 69, 213)
labels_gt_cpu SHAPE (1, 1, 70, 69, 213)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 0.17690625000000182, Volume error (%): 0.24710000686389164
Eccentricity (pred): 0.9871412543804406, Eccentricity (GT): 0.9869423443316044
Curvature (pred): 4.575623544954139, Curvature (GT): 4.507550856564455
Batch ASD: 0.3596, HSD: 5.8896, HSD95: 1.7002, DSC: 0.9311, err_vol_cm_3: 0.1769, err_vol_percent: 0.2471, Eccentricity (pred): 0.9871, Eccentricity (GT): 0.9869, Curvature (pred): 4.5756, Curvature (GT): 4.5076
Shape of labels_lr: torch.Size([1, 70, 69, 213])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 69,  68, 210],
        [ 69,  68, 211],
        [ 69,  68, 212]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 6/16
Batch cases: ['RA126_RF']
Step 0100/1500: loss 0.2292 DSC 0.805 L2^2(z): 20.34 (11.4s)
Step 0200/1500: loss 0.1981 DSC 0.832 L2^2(z): 25.39 (11.4s)
Step 0300/1500: loss 0.1727 DSC 0.852 L2^2(z): 34.05 (11.4s)
Step 0400/1500: loss 0.1537 DSC 0.870 L2^2(z): 44.57 (11.4s)
Step 0500/1500: loss 0.1450 DSC 0.878 L2^2(z): 52.56 (11.4s)
Step 0600/1500: loss 0.1389 DSC 0.884 L2^2(z): 59.67 (11.4s)
Step 0700/1500: loss 0.1334 DSC 0.888 L2^2(z): 66.42 (11.4s)
Step 0800/1500: loss 0.1285 DSC 0.894 L2^2(z): 72.62 (11.4s)
Step 0900/1500: loss 0.1246 DSC 0.899 L2^2(z): 78.89 (11.4s)
Step 1000/1500: loss 0.1217 DSC 0.902 L2^2(z): 85.16 (11.4s)
Step 1100/1500: loss 0.1189 DSC 0.906 L2^2(z): 93.06 (11.4s)
Step 1200/1500: loss 0.1166 DSC 0.910 L2^2(z): 100.74 (11.4s)
Step 1300/1500: loss 0.1148 DSC 0.911 L2^2(z): 106.36 (11.4s)
Step 1400/1500: loss 0.1129 DSC 0.913 L2^2(z): 112.07 (11.4s)
Step 1500/1500: loss 0.1115 DSC 0.915 L2^2(z): 117.35 (11.4s)
L2^2(z): 117.3467
z: Parameter containing:
tensor([[-1.6497,  0.6631, -0.8254, -0.0414,  0.4036,  2.5557, -0.3041, -0.6272,
         -0.6179, -0.4151, -0.5539,  1.0212, -0.2471,  0.0761,  0.5979, -1.2756,
          1.1987, -0.5404,  0.3109, -1.8920, -0.0808, -0.5901, -0.3274,  0.3546,
         -0.1273,  0.0128,  1.3918,  0.5907, -0.1497, -0.2492, -0.2446, -0.6353,
          0.5337,  1.2118,  0.8595,  0.3320, -1.1658,  0.5590,  0.3588,  0.6895,
         -0.3483, -0.9670,  0.7022,  1.6215, -0.9896, -1.2276,  0.4744,  0.0752,
          0.1587,  0.8766,  0.5465,  0.4005,  0.2326,  1.1777,  0.4525, -1.1216,
         -0.4402, -1.0704, -1.5692, -0.1612,  0.2981, -0.3544,  0.3264,  0.5091,
          1.3966, -0.2382, -0.9606,  0.6679,  0.9540, -0.5494,  1.4780,  1.7893,
          0.2398,  0.6512,  1.9462,  2.0682, -0.8678, -0.4606,  0.0503, -1.3161,
         -1.6775, -0.7024, -1.4523,  0.7535, -0.0644,  1.5342, -0.8075, -0.2993,
         -0.4039, -0.6567,  2.2436, -1.3604, -1.1516,  0.3570, -0.1005,  0.8442,
          0.0074,  1.3751, -0.0325, -2.7691, -0.7895,  0.1685, -1.1878,  1.1902,
         -0.1377,  0.4644,  0.8576, -0.1394,  0.0844, -0.0972, -1.2372,  1.3087,
          1.4273, -0.3025,  0.7936, -1.6189,  1.9304,  0.2452,  1.0954, -0.5210,
          0.3659, -0.3422, -0.3199, -1.1381,  1.2109,  0.8290, -1.2054,  0.2096]],
       device='cuda:0', requires_grad=True)
tensor([106,  54, 178])
tensor([106,  54, 178])
Batch prediction time: 171.3s
labels_pred_cpu SHAPE (1, 1, 106, 54, 178)
labels_gt_cpu SHAPE (1, 1, 106, 54, 178)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 1.5099218749999892, Volume error (%): 2.1086935684846013
Eccentricity (pred): 0.9882334295814248, Eccentricity (GT): 0.9896751401401951
Curvature (pred): 4.762914946938692, Curvature (GT): 4.652610510885449
Batch ASD: 0.5668, HSD: 16.3478, HSD95: 3.8008, DSC: 0.9149, err_vol_cm_3: 1.5099, err_vol_percent: 2.1087, Eccentricity (pred): 0.9882, Eccentricity (GT): 0.9897, Curvature (pred): 4.7629, Curvature (GT): 4.6526
Shape of labels_lr: torch.Size([1, 106, 54, 178])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [105,  53, 175],
        [105,  53, 176],
        [105,  53, 177]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 7/16
Batch cases: ['RY166_RF']
Step 0100/1500: loss 0.2438 DSC 0.817 L2^2(z): 18.56 (10.8s)
Step 0200/1500: loss 0.2104 DSC 0.840 L2^2(z): 26.01 (10.8s)
Step 0300/1500: loss 0.1919 DSC 0.853 L2^2(z): 33.60 (10.8s)
Step 0400/1500: loss 0.1770 DSC 0.863 L2^2(z): 42.09 (10.8s)
Step 0500/1500: loss 0.1699 DSC 0.869 L2^2(z): 50.51 (10.8s)
Step 0600/1500: loss 0.1611 DSC 0.877 L2^2(z): 61.60 (10.8s)
Step 0700/1500: loss 0.1568 DSC 0.880 L2^2(z): 70.00 (10.8s)
Step 0800/1500: loss 0.1529 DSC 0.884 L2^2(z): 78.88 (10.8s)
Step 0900/1500: loss 0.1497 DSC 0.886 L2^2(z): 88.19 (10.8s)
Step 1000/1500: loss 0.1472 DSC 0.889 L2^2(z): 96.48 (10.8s)
Step 1100/1500: loss 0.1445 DSC 0.892 L2^2(z): 104.88 (10.8s)
Step 1200/1500: loss 0.1367 DSC 0.899 L2^2(z): 116.27 (10.8s)
Step 1300/1500: loss 0.1314 DSC 0.904 L2^2(z): 124.22 (10.8s)
Step 1400/1500: loss 0.1292 DSC 0.906 L2^2(z): 130.60 (10.8s)
Step 1500/1500: loss 0.1273 DSC 0.908 L2^2(z): 137.49 (10.8s)
L2^2(z): 137.4877
z: Parameter containing:
tensor([[ 3.4964e+00,  5.6008e-01, -7.5087e-01, -1.7224e+00,  5.1536e-01,
          6.3206e-01, -4.6463e-01, -3.7409e-01,  1.4442e+00, -1.4243e+00,
         -5.9938e-01, -3.5191e-01,  8.5047e-01, -6.9809e-01, -4.9111e-01,
          8.1723e-01,  6.1062e-01, -2.0221e+00, -4.0771e-01,  1.3588e+00,
         -6.9153e-01,  3.7553e-01, -6.2993e-01, -1.0542e+00, -2.5671e-01,
          2.6219e+00,  3.4573e-01,  1.4276e+00,  3.8015e-01, -6.4938e-01,
         -9.4379e-01, -6.9896e-01, -6.2405e-01,  1.1573e+00, -7.9469e-01,
          1.7867e+00,  5.8653e-01,  4.6388e-02, -1.2687e+00,  1.1754e-01,
          5.6779e-01,  1.0564e+00,  3.0738e-03, -6.8554e-02, -1.2561e+00,
          6.8237e-01,  1.0565e+00, -2.0570e-01,  1.0878e+00,  3.0307e-01,
          1.6947e+00, -5.4115e-01, -5.7136e-01, -1.0764e+00, -6.3844e-01,
         -3.9738e-01, -2.6115e-01, -7.7405e-01, -6.8885e-01, -8.2098e-03,
          6.3919e-01, -6.2218e-01, -2.0732e+00,  4.7262e-01,  8.7949e-01,
         -2.1591e+00,  4.3196e-01, -1.0853e+00, -4.8282e-02, -1.0648e-01,
          1.9093e+00,  8.9987e-01, -1.1241e+00, -8.8808e-01,  7.3251e-01,
         -9.5590e-01, -1.9159e-01, -1.4635e+00, -1.0311e+00, -1.3430e+00,
          1.1654e-01, -9.2354e-01, -2.5357e+00,  1.1948e+00,  2.0810e-01,
         -3.7519e-01, -1.1696e+00,  1.8179e-01, -4.3229e-01,  1.8023e+00,
         -4.0235e-01,  9.6840e-01,  8.5834e-01, -1.0094e+00,  5.2157e-01,
          5.4149e-01,  2.8448e-01, -1.6870e-01,  1.4412e+00, -3.6098e-01,
         -4.5198e-01,  3.1800e-01,  3.0374e-02, -4.3848e-01, -4.0309e-01,
         -7.5748e-01,  4.2852e-01, -1.4911e+00, -2.9874e-01, -1.6461e+00,
          8.0347e-01,  5.9536e-01,  1.2582e-01, -1.4223e-01,  8.3099e-01,
          4.3525e-01, -1.2033e+00, -1.1190e+00, -5.8626e-01,  4.3580e-01,
          1.2747e-01, -6.0310e-01,  3.5101e-01, -2.6187e+00,  1.2749e+00,
          1.2178e+00, -2.3006e+00,  1.5058e+00]], device='cuda:0',
       requires_grad=True)
tensor([ 75,  63, 204])
tensor([ 75,  63, 204])
Batch prediction time: 162.6s
labels_pred_cpu SHAPE (1, 1, 75, 63, 204)
labels_gt_cpu SHAPE (1, 1, 75, 63, 204)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 0.9238437500000032, Volume error (%): 0.9940778341793604
Eccentricity (pred): 0.9736365675804735, Eccentricity (GT): 0.9710533171204712
Curvature (pred): 4.893974391631543, Curvature (GT): 4.787307803986002
Batch ASD: 0.4977, HSD: 10.8866, HSD95: 2.4044, DSC: 0.9077, err_vol_cm_3: 0.9238, err_vol_percent: 0.9941, Eccentricity (pred): 0.9736, Eccentricity (GT): 0.9711, Curvature (pred): 4.8940, Curvature (GT): 4.7873
Shape of labels_lr: torch.Size([1, 75, 63, 204])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 74,  62, 201],
        [ 74,  62, 202],
        [ 74,  62, 203]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 8/16
Batch cases: ['sujet12_RF_faible']
Step 0100/1500: loss 0.2018 DSC 0.871 L2^2(z): 30.55 (10.3s)
Step 0200/1500: loss 0.1402 DSC 0.908 L2^2(z): 36.01 (10.3s)
Step 0300/1500: loss 0.1248 DSC 0.917 L2^2(z): 40.68 (10.3s)
Step 0400/1500: loss 0.1150 DSC 0.922 L2^2(z): 44.71 (10.3s)
Step 0500/1500: loss 0.1094 DSC 0.926 L2^2(z): 47.80 (10.3s)
Step 0600/1500: loss 0.1054 DSC 0.929 L2^2(z): 51.14 (10.3s)
Step 0700/1500: loss 0.1023 DSC 0.931 L2^2(z): 54.53 (10.3s)
Step 0800/1500: loss 0.1000 DSC 0.933 L2^2(z): 57.81 (10.3s)
Step 0900/1500: loss 0.0981 DSC 0.935 L2^2(z): 61.10 (10.3s)
Step 1000/1500: loss 0.0965 DSC 0.936 L2^2(z): 64.39 (10.3s)
Step 1100/1500: loss 0.0953 DSC 0.937 L2^2(z): 67.14 (10.3s)
Step 1200/1500: loss 0.0943 DSC 0.938 L2^2(z): 69.46 (10.3s)
Step 1300/1500: loss 0.0932 DSC 0.938 L2^2(z): 71.63 (10.3s)
Step 1400/1500: loss 0.0922 DSC 0.939 L2^2(z): 73.96 (10.3s)
Step 1500/1500: loss 0.0912 DSC 0.940 L2^2(z): 76.29 (10.3s)
L2^2(z): 76.2866
z: Parameter containing:
tensor([[ 0.8185,  0.2069,  0.2727,  0.9146, -0.5398, -0.6538,  0.1423, -0.7176,
          1.4154,  1.3849, -0.1837, -0.4695,  0.3420, -0.1387, -1.0534, -0.5182,
         -0.8711, -0.3178,  0.0687,  0.3565, -0.3640, -0.9459, -1.1081, -1.2729,
         -0.4442,  0.2043,  0.2642, -0.9596, -0.7456, -0.6881, -0.9227, -1.1821,
          0.6876, -0.1181, -0.2924,  0.3611,  0.8495, -1.1206,  0.1173, -0.7077,
         -0.7307, -0.0185,  0.2048, -0.6092,  1.0972, -0.6179,  0.6184,  0.1139,
         -0.6869,  1.0014, -0.8336, -0.8168,  0.0114,  0.4474,  0.0474,  0.3468,
         -0.5440,  0.3132, -0.7682,  1.0001,  1.3204,  0.6740, -0.7510,  1.1856,
         -0.2000,  0.0197,  0.6018, -1.0763, -0.6654, -1.2402, -0.4100, -1.0428,
          0.0165, -0.2965,  0.4612,  1.5607, -0.5020,  1.2209, -0.6173, -0.5457,
         -0.6495,  0.6280,  1.0118, -0.8168, -0.0678, -0.7421, -0.4776, -0.1687,
          0.1268,  1.0108,  0.2094,  0.8023, -0.2212,  0.1041,  0.6748, -0.2748,
          0.3046, -0.3523,  0.9983, -0.7066,  2.0076,  0.9279, -0.1325,  0.6121,
         -0.8109, -0.6406,  0.6384, -0.5143,  1.9923,  0.3788,  0.2825,  2.0190,
         -1.1036,  0.4532, -0.6297, -0.4931,  1.9566, -0.7647, -0.4536, -0.5393,
         -0.9192,  0.3967,  0.4809,  0.2379,  0.7894,  0.8666,  0.6509,  0.5037]],
       device='cuda:0', requires_grad=True)
tensor([ 63,  69, 211])
tensor([ 63,  69, 211])
Batch prediction time: 154.5s
labels_pred_cpu SHAPE (1, 1, 63, 69, 211)
labels_gt_cpu SHAPE (1, 1, 63, 69, 211)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 0.7174531249999916, Volume error (%): 0.41403170461956806
Eccentricity (pred): 0.98682097587936, Eccentricity (GT): 0.9868627690812506
Curvature (pred): 4.799871895985774, Curvature (GT): 4.7277234642835655
Batch ASD: 0.4990, HSD: 6.8008, HSD95: 1.7002, DSC: 0.9403, err_vol_cm_3: 0.7175, err_vol_percent: 0.4140, Eccentricity (pred): 0.9868, Eccentricity (GT): 0.9869, Curvature (pred): 4.7999, Curvature (GT): 4.7277
Shape of labels_lr: torch.Size([1, 63, 69, 211])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 62,  68, 208],
        [ 62,  68, 209],
        [ 62,  68, 210]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 9/16
Batch cases: ['sujet12_RF_fort']
Step 0100/1500: loss 0.0944 DSC 0.932 L2^2(z): 26.43 (11.5s)
Step 0200/1500: loss 0.0814 DSC 0.942 L2^2(z): 28.41 (11.5s)
Step 0300/1500: loss 0.0763 DSC 0.947 L2^2(z): 30.15 (11.6s)
Step 0400/1500: loss 0.0725 DSC 0.949 L2^2(z): 32.38 (11.5s)
Step 0500/1500: loss 0.0695 DSC 0.952 L2^2(z): 34.94 (11.6s)
Step 0600/1500: loss 0.0673 DSC 0.953 L2^2(z): 37.65 (11.6s)
Step 0700/1500: loss 0.0655 DSC 0.955 L2^2(z): 40.25 (11.6s)
Step 0800/1500: loss 0.0638 DSC 0.957 L2^2(z): 42.82 (11.6s)
Step 0900/1500: loss 0.0622 DSC 0.959 L2^2(z): 45.46 (11.6s)
Step 1000/1500: loss 0.0605 DSC 0.960 L2^2(z): 48.32 (11.6s)
Step 1100/1500: loss 0.0591 DSC 0.962 L2^2(z): 51.18 (11.6s)
Step 1200/1500: loss 0.0581 DSC 0.963 L2^2(z): 53.52 (11.6s)
Step 1300/1500: loss 0.0574 DSC 0.964 L2^2(z): 55.53 (11.5s)
Step 1400/1500: loss 0.0569 DSC 0.964 L2^2(z): 57.36 (11.5s)
Step 1500/1500: loss 0.0564 DSC 0.965 L2^2(z): 59.11 (11.5s)
L2^2(z): 59.1138
z: Parameter containing:
tensor([[ 8.8081e-01,  1.2743e+00, -1.4494e-01,  2.2571e-01, -1.2317e+00,
         -3.2945e-01,  5.4677e-01, -9.1454e-01,  1.0021e+00, -2.8712e-01,
          2.7960e-02, -6.2245e-01,  4.9759e-01,  4.0856e-01, -7.4412e-01,
          8.0598e-01, -8.6830e-01,  6.3677e-01, -3.2007e-01,  6.5092e-01,
          4.5985e-01, -9.9601e-01, -2.7822e-01, -7.8706e-01, -2.6275e-01,
         -6.0913e-01, -1.1358e+00, -3.9396e-01, -3.2335e-01, -7.4183e-01,
          2.9471e-03, -1.1365e-01, -9.0022e-01,  6.5794e-01, -2.0082e-01,
          9.4396e-01,  1.6353e+00, -3.7522e-01,  9.4341e-03,  4.0384e-01,
         -3.5021e-01, -6.7906e-03, -1.2665e+00, -6.5724e-01,  2.2150e-01,
          8.7062e-01, -6.4564e-03,  1.4376e-01, -6.8191e-01,  7.0371e-01,
          1.2052e+00, -2.1734e-01, -2.7774e-01, -8.5175e-01, -6.2095e-01,
          6.7762e-01, -2.6331e-01,  2.9875e-01, -6.3377e-01,  1.5496e+00,
         -2.4454e-01, -2.2734e-01, -7.8552e-01,  1.6163e-01, -1.3243e-01,
         -2.2637e-01,  2.5513e-01,  7.8071e-01, -3.0078e-01, -3.3295e-01,
         -9.6390e-02, -2.0957e-01,  1.6806e+00,  2.1117e-01, -6.0770e-01,
          3.0980e-01, -8.0304e-01,  9.3297e-02, -7.2385e-01,  6.8248e-01,
         -3.4074e-01, -1.2560e+00, -1.0047e+00, -1.7100e-01, -1.2903e-01,
         -8.9760e-01, -1.3778e-01, -2.8817e-01, -1.4636e+00,  8.8326e-01,
         -1.7226e-01,  9.2346e-01, -3.8410e-01, -1.0641e+00,  1.7085e-01,
         -2.2189e-01, -5.1455e-02, -4.7332e-01, -1.6735e-01, -5.8868e-02,
          2.1286e-01,  8.0121e-02, -3.6414e-01,  2.4990e-01, -1.1735e+00,
         -5.7003e-01, -1.1468e+00, -2.7854e-01,  1.1891e+00, -1.5012e+00,
          9.1987e-03,  7.8049e-01, -3.7239e-01,  5.7152e-01, -9.2385e-01,
         -2.3561e-01,  4.2729e-01, -2.0343e-01, -7.7583e-01, -5.7944e-01,
          4.6053e-02, -2.0549e-01,  3.3699e-01,  6.6091e-01,  4.1366e-01,
         -1.4543e+00,  7.7351e-01, -1.8965e-04]], device='cuda:0',
       requires_grad=True)
tensor([ 70,  66, 223])
tensor([ 70,  66, 223])
Batch prediction time: 173.3s
labels_pred_cpu SHAPE (1, 1, 70, 66, 223)
labels_gt_cpu SHAPE (1, 1, 70, 66, 223)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 0.7245937500000252, Volume error (%): 0.42983073896890683
Eccentricity (pred): 0.9875270205557158, Eccentricity (GT): 0.987680174936192
Curvature (pred): 4.889155843869901, Curvature (GT): 4.8372972216798855
Batch ASD: 0.2690, HSD: 7.9980, HSD95: 1.5996, DSC: 0.9648, err_vol_cm_3: 0.7246, err_vol_percent: 0.4298, Eccentricity (pred): 0.9875, Eccentricity (GT): 0.9877, Curvature (pred): 4.8892, Curvature (GT): 4.8373
Shape of labels_lr: torch.Size([1, 70, 66, 223])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 69,  65, 220],
        [ 69,  65, 221],
        [ 69,  65, 222]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 10/16
Batch cases: ['sujet12_RF_pad']
Step 0100/1500: loss 0.1244 DSC 0.907 L2^2(z): 25.40 (11.1s)
Step 0200/1500: loss 0.0911 DSC 0.932 L2^2(z): 29.55 (11.1s)
Step 0300/1500: loss 0.0832 DSC 0.939 L2^2(z): 31.99 (11.1s)
Step 0400/1500: loss 0.0771 DSC 0.944 L2^2(z): 35.47 (11.1s)
Step 0500/1500: loss 0.0720 DSC 0.948 L2^2(z): 40.07 (11.1s)
Step 0600/1500: loss 0.0676 DSC 0.952 L2^2(z): 45.41 (11.1s)
Step 0700/1500: loss 0.0644 DSC 0.955 L2^2(z): 50.67 (11.1s)
Step 0800/1500: loss 0.0626 DSC 0.957 L2^2(z): 55.22 (11.1s)
Step 0900/1500: loss 0.0609 DSC 0.958 L2^2(z): 59.00 (11.1s)
Step 1000/1500: loss 0.0589 DSC 0.960 L2^2(z): 63.20 (11.1s)
Step 1100/1500: loss 0.0581 DSC 0.961 L2^2(z): 66.47 (11.1s)
Step 1200/1500: loss 0.0575 DSC 0.962 L2^2(z): 68.45 (11.1s)
Step 1300/1500: loss 0.0571 DSC 0.962 L2^2(z): 70.01 (11.1s)
Step 1400/1500: loss 0.0567 DSC 0.962 L2^2(z): 71.25 (11.1s)
Step 1500/1500: loss 0.0564 DSC 0.963 L2^2(z): 72.25 (11.1s)
L2^2(z): 72.2491
z: Parameter containing:
tensor([[-2.6225e-01,  2.0636e-01,  9.1634e-02,  8.8015e-01, -1.7893e+00,
         -1.1435e+00,  1.0338e+00, -6.7179e-01, -7.3349e-01, -1.1735e+00,
          6.2102e-01, -3.8945e-01, -1.0119e+00,  5.3469e-01, -2.9904e-01,
          2.2436e-01, -6.9498e-01, -1.2584e+00,  2.3912e-01,  8.3559e-01,
          8.9525e-02,  5.8333e-01, -5.0835e-01, -9.5066e-01,  1.5684e-02,
          3.0066e-01, -9.8613e-01,  6.9281e-02, -2.0652e-01,  3.2666e-01,
          1.0053e-01,  2.8551e-01, -2.5190e-01, -7.4018e-01, -2.6859e-01,
         -7.9908e-01,  8.6157e-01, -3.0086e-01,  3.5743e-01, -1.1181e+00,
         -5.6189e-01,  4.6356e-01, -3.9207e-01, -3.7308e-01, -1.1873e-01,
          1.9565e-03,  1.3031e-01, -3.4295e-01, -7.2016e-01,  2.4611e-01,
          1.4487e-02,  1.2453e-01, -7.6959e-01, -5.5552e-01, -2.4230e-01,
         -3.5781e-01, -1.1496e+00,  2.2033e-02, -6.0578e-01, -5.5262e-01,
          1.3314e+00,  1.4430e-01, -2.9150e-02,  8.1210e-01, -8.7959e-01,
          1.6079e-01, -1.3935e+00, -5.2803e-01,  1.7202e-02, -6.1750e-01,
          1.3396e-01, -6.6736e-01,  2.2889e+00,  2.3407e+00,  8.3414e-01,
          6.7311e-01, -4.9630e-01,  4.6166e-01, -4.6750e-01,  4.9979e-01,
          1.3011e+00, -7.1421e-01, -1.3950e+00, -8.3912e-01, -5.7259e-01,
         -7.1587e-01,  4.9834e-01, -6.0322e-02, -2.8288e-02, -8.0408e-01,
         -1.1408e+00,  4.4817e-01, -7.7019e-01,  5.6981e-01,  1.2333e+00,
         -3.4333e-01,  5.7790e-01, -5.9408e-01, -3.7171e-01,  1.1400e+00,
         -1.0126e-01,  3.3136e-01,  6.3659e-01,  1.0405e+00, -3.5873e-01,
         -1.4828e+00, -1.2355e+00, -4.6641e-01,  3.8445e-01, -1.2742e-01,
          1.3408e-01,  4.1683e-02, -1.8349e-01,  7.3279e-01,  8.5177e-02,
         -6.4546e-01, -9.8554e-01, -8.9178e-01,  1.4712e+00, -4.8553e-01,
         -1.8272e-01, -3.0538e-01,  7.7289e-01, -2.4355e-01,  1.5919e-01,
         -2.1435e-01,  1.8756e+00,  5.6018e-01]], device='cuda:0',
       requires_grad=True)
tensor([ 66,  73, 205])
tensor([ 66,  73, 205])
Batch prediction time: 166.0s
labels_pred_cpu SHAPE (1, 1, 66, 73, 205)
labels_gt_cpu SHAPE (1, 1, 66, 73, 205)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 0.4665625000000091, Volume error (%): 0.26233808821118726
Eccentricity (pred): 0.9841331381971736, Eccentricity (GT): 0.9840946509604833
Curvature (pred): 4.850385356144075, Curvature (GT): 4.793048544335151
Batch ASD: 0.2893, HSD: 5.9693, HSD95: 1.7998, DSC: 0.9628, err_vol_cm_3: 0.4666, err_vol_percent: 0.2623, Eccentricity (pred): 0.9841, Eccentricity (GT): 0.9841, Curvature (pred): 4.8504, Curvature (GT): 4.7930
Shape of labels_lr: torch.Size([1, 66, 73, 205])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 65,  72, 202],
        [ 65,  72, 203],
        [ 65,  72, 204]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 11/16
Batch cases: ['sujet4_RF_faible']
Step 0100/1500: loss 0.2820 DSC 0.847 L2^2(z): 40.89 (10.6s)
Step 0200/1500: loss 0.1675 DSC 0.904 L2^2(z): 48.04 (10.6s)
Step 0300/1500: loss 0.1506 DSC 0.913 L2^2(z): 51.09 (10.6s)
Step 0400/1500: loss 0.1393 DSC 0.919 L2^2(z): 54.72 (10.6s)
Step 0500/1500: loss 0.1311 DSC 0.923 L2^2(z): 58.52 (10.6s)
Step 0600/1500: loss 0.1240 DSC 0.928 L2^2(z): 63.14 (10.6s)
Step 0700/1500: loss 0.1177 DSC 0.932 L2^2(z): 68.52 (10.6s)
Step 0800/1500: loss 0.1129 DSC 0.935 L2^2(z): 73.50 (10.6s)
Step 0900/1500: loss 0.1091 DSC 0.938 L2^2(z): 78.22 (10.6s)
Step 1000/1500: loss 0.1061 DSC 0.940 L2^2(z): 82.85 (10.6s)
Step 1100/1500: loss 0.1033 DSC 0.941 L2^2(z): 87.39 (10.6s)
Step 1200/1500: loss 0.1009 DSC 0.943 L2^2(z): 91.59 (10.6s)
Step 1300/1500: loss 0.0989 DSC 0.944 L2^2(z): 94.85 (10.6s)
Step 1400/1500: loss 0.0974 DSC 0.945 L2^2(z): 97.29 (10.6s)
Step 1500/1500: loss 0.0962 DSC 0.945 L2^2(z): 99.62 (10.6s)
L2^2(z): 99.6160
z: Parameter containing:
tensor([[ 0.7998, -0.1735,  0.3837,  0.9583,  0.0185, -1.1970, -0.0332,  0.3393,
          0.2533, -0.0464,  0.9079,  0.0285,  0.1168,  0.9194, -0.6118, -1.4009,
         -1.6022,  0.2157, -0.6176,  0.4129,  1.1404, -1.4793, -0.6888, -2.6944,
         -0.0958, -0.6096, -0.3057, -0.7345,  0.5654, -0.1642, -0.0340, -0.4650,
          1.0974,  0.7645, -1.0852, -0.4422,  0.9528, -0.1640,  1.1022, -0.5283,
          0.0033,  0.9852,  1.6528,  0.5825, -0.3119, -1.5207,  1.2647,  1.1643,
         -0.7068,  0.5603,  0.3303, -0.6518, -0.6555, -0.9626, -0.4211,  0.1172,
         -0.1813,  0.8123, -0.0232, -0.5677,  1.0201,  1.1954, -1.9704,  2.7272,
         -0.0341, -0.3441,  0.4639,  0.4024, -1.0185, -1.5332,  0.9176, -0.2580,
          0.2298,  1.2360, -0.6410,  1.4441, -0.7007,  0.6798, -0.2024,  0.0849,
         -0.3435, -0.0145,  0.5321, -0.3351, -0.0861,  0.2408, -1.3766, -0.7388,
          0.4450,  0.0361, -0.0203,  0.4635, -0.8163,  0.6143,  0.0448, -0.3651,
          0.8764, -0.2605,  1.0688, -1.1184,  0.4563,  1.0025,  0.4127,  0.8338,
          1.2429, -0.1932, -1.5393, -0.6646,  0.2640,  0.5600,  0.8469,  0.1530,
         -1.7147, -0.1264,  1.7661, -0.9058,  1.9722,  0.6881, -1.0084, -0.2635,
          1.4923, -0.7268,  0.7702,  0.5611,  0.7759,  0.3497,  0.9733,  0.7685]],
       device='cuda:0', requires_grad=True)
tensor([ 64,  69, 213])
tensor([ 64,  69, 213])
Batch prediction time: 158.3s
labels_pred_cpu SHAPE (1, 1, 64, 69, 213)
labels_gt_cpu SHAPE (1, 1, 64, 69, 213)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 3.5282968749999952, Volume error (%): 1.4285714285714266
Eccentricity (pred): 0.9768713479084077, Eccentricity (GT): 0.9763053930467233
Curvature (pred): 4.894356997134605, Curvature (GT): 4.860194114816497
Batch ASD: 0.5896, HSD: 11.9014, HSD95: 2.4044, DSC: 0.9453, err_vol_cm_3: 3.5283, err_vol_percent: 1.4286, Eccentricity (pred): 0.9769, Eccentricity (GT): 0.9763, Curvature (pred): 4.8944, Curvature (GT): 4.8602
Shape of labels_lr: torch.Size([1, 64, 69, 213])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 63,  68, 210],
        [ 63,  68, 211],
        [ 63,  68, 212]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 12/16
Batch cases: ['sujet4_RF_fort']
Step 0100/1500: loss 1.0465 DSC 0.000 L2^2(z): 27.80 (11.5s)
Step 0200/1500: loss 1.0390 DSC 0.000 L2^2(z): 28.53 (11.5s)
Step 0300/1500: loss 1.0358 DSC 0.000 L2^2(z): 29.87 (11.5s)
Step 0400/1500: loss 1.0332 DSC 0.000 L2^2(z): 31.68 (11.5s)
Step 0500/1500: loss 1.0309 DSC 0.000 L2^2(z): 34.03 (11.5s)
Step 0600/1500: loss 1.0288 DSC 0.000 L2^2(z): 37.00 (11.5s)
Step 0700/1500: loss 1.0271 DSC 0.000 L2^2(z): 39.94 (11.5s)
Step 0800/1500: loss 1.0260 DSC 0.000 L2^2(z): 42.29 (11.5s)
Step 0900/1500: loss 1.0253 DSC 0.000 L2^2(z): 44.25 (11.5s)
Step 1000/1500: loss 1.0247 DSC 0.000 L2^2(z): 45.88 (11.5s)
Step 1100/1500: loss 1.0241 DSC 0.000 L2^2(z): 47.30 (11.5s)
Step 1200/1500: loss 1.0237 DSC 0.000 L2^2(z): 48.57 (11.5s)
Step 1300/1500: loss 1.0232 DSC 0.000 L2^2(z): 49.69 (11.5s)
Step 1400/1500: loss 1.0229 DSC 0.000 L2^2(z): 50.62 (11.5s)
Step 1500/1500: loss 1.0226 DSC 0.000 L2^2(z): 51.43 (11.5s)
L2^2(z): 51.4304
z: Parameter containing:
tensor([[-0.1596,  0.6063,  1.0540, -1.8700, -0.5345, -0.4199,  1.0341, -0.6949,
          0.6228, -0.0877,  0.7573, -1.3873,  0.3006,  1.0105,  0.9142,  0.8602,
         -0.0896,  0.5664,  0.2153,  0.1161, -1.2272, -0.8948, -0.5569, -0.1661,
         -0.4251, -0.1020, -0.3284, -0.3170, -0.0254, -0.1913, -0.0636, -0.1609,
          0.9931, -0.0034, -1.1316,  0.2159, -0.4591, -0.4439,  0.0819, -1.1806,
          0.1041, -0.0518, -0.2149, -0.5781, -0.7480,  0.7534, -0.2686,  0.6115,
         -0.7502,  0.4788, -0.4131, -0.2754, -0.3454, -0.6884, -0.4188,  0.0278,
         -0.4815,  0.6082, -0.3526, -1.1997,  1.7221,  0.3426, -0.9450,  0.6084,
         -0.5287, -0.4681,  0.0355,  0.7181, -0.1978, -0.1889,  0.0685, -0.2056,
         -0.0519,  0.0642, -0.2759,  0.8237, -0.6152, -0.6364, -0.5937,  0.5932,
         -0.8106, -1.0187,  0.1260, -0.2499,  0.2739, -0.1237, -0.7702, -0.5542,
         -0.9076, -0.6283, -0.1992,  0.5682, -0.7222, -0.6627,  0.4758, -0.1593,
          0.9676, -0.5995,  0.5184,  0.4521, -0.4260,  0.5062, -0.3521,  0.4869,
         -0.4593, -1.0241, -1.1334, -0.3998, -0.1277, -0.3709,  0.3359,  0.1428,
          1.0969,  0.3497,  0.6363, -0.5309,  0.8741,  0.3835, -0.5180, -0.7906,
         -0.0132, -0.3413,  0.8098,  0.5229,  0.5085, -0.5799,  0.2267,  0.9566]],
       device='cuda:0', requires_grad=True)
tensor([ 75,  64, 213])
tensor([ 75,  64, 213])
Batch prediction time: 172.1s
labels_pred_cpu SHAPE (1, 1, 75, 64, 213)
labels_gt_cpu SHAPE (1, 1, 75, 64, 213)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 1.1036249999999939, Volume error (%): 0.4900858774335659
Eccentricity (pred): 0.9786148718852532, Eccentricity (GT): 0.9790336016174496
Curvature (pred): 4.944173089881996, Curvature (GT): 4.887807033649863
Batch ASD: 0.4502, HSD: 4.9749, HSD95: 1.5000, DSC: 0.9535, err_vol_cm_3: 1.1036, err_vol_percent: 0.4901, Eccentricity (pred): 0.9786, Eccentricity (GT): 0.9790, Curvature (pred): 4.9442, Curvature (GT): 4.8878
Shape of labels_lr: torch.Size([1, 75, 64, 213])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 74,  63, 210],
        [ 74,  63, 211],
        [ 74,  63, 212]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 13/16
Batch cases: ['sujet4_RF_pad']
Step 0100/1500: loss 0.2214 DSC 0.862 L2^2(z): 30.32 (10.6s)
Step 0200/1500: loss 0.1621 DSC 0.896 L2^2(z): 38.38 (10.6s)
Step 0300/1500: loss 0.1391 DSC 0.910 L2^2(z): 43.84 (10.6s)
Step 0400/1500: loss 0.1198 DSC 0.922 L2^2(z): 51.96 (10.6s)
Step 0500/1500: loss 0.1089 DSC 0.929 L2^2(z): 59.23 (10.6s)
Step 0600/1500: loss 0.1015 DSC 0.934 L2^2(z): 65.15 (10.6s)
Step 0700/1500: loss 0.0945 DSC 0.939 L2^2(z): 71.23 (10.6s)
Step 0800/1500: loss 0.0891 DSC 0.942 L2^2(z): 78.41 (10.6s)
Step 0900/1500: loss 0.0845 DSC 0.946 L2^2(z): 86.01 (10.6s)
Step 1000/1500: loss 0.0805 DSC 0.949 L2^2(z): 93.83 (10.6s)
Step 1100/1500: loss 0.0776 DSC 0.951 L2^2(z): 101.05 (10.6s)
Step 1200/1500: loss 0.0755 DSC 0.953 L2^2(z): 107.36 (10.6s)
Step 1300/1500: loss 0.0740 DSC 0.954 L2^2(z): 112.44 (10.6s)
Step 1400/1500: loss 0.0727 DSC 0.956 L2^2(z): 117.15 (10.6s)
Step 1500/1500: loss 0.0716 DSC 0.957 L2^2(z): 121.62 (10.6s)
L2^2(z): 121.6245
z: Parameter containing:
tensor([[-1.0090e+00,  8.7634e-01,  3.7562e-01,  1.4468e+00, -5.7076e-02,
         -9.4825e-01,  3.9946e-01,  3.3045e-01, -3.9542e-01, -2.5575e-01,
         -1.2020e-01, -3.3097e-01,  3.2902e-01,  1.2375e+00,  4.7218e-01,
         -1.7692e+00,  1.2834e-01, -5.4696e-02,  3.5216e-01, -5.2907e-01,
         -2.7218e+00, -6.2260e-01, -1.1807e+00,  9.3860e-01, -1.8333e-01,
          2.0324e+00, -2.5207e+00, -1.5410e+00,  1.9060e+00, -4.4228e-03,
          1.3381e+00, -2.4745e+00,  1.0070e+00,  5.0564e-01, -7.0915e-01,
          4.0853e-02, -7.5228e-01, -3.7048e-01, -5.6497e-01,  5.3418e-01,
          1.2287e+00,  6.2618e-01, -6.2903e-01,  5.3935e-01, -8.0685e-01,
         -1.1682e+00,  1.0578e+00,  1.0414e+00, -3.5142e-01,  4.3633e-01,
         -1.4150e+00,  1.3878e+00, -1.0561e+00, -1.9011e+00, -3.1189e-01,
          7.2293e-01, -1.8037e-01,  6.1022e-01, -4.7563e-01, -9.4975e-01,
          8.3141e-01, -1.4627e-01, -2.8925e+00,  9.1574e-01, -5.1206e-01,
         -1.7061e+00,  1.3179e-01,  2.2281e-01, -6.6605e-01, -3.2379e-01,
         -2.4322e-01, -7.8087e-01,  2.2611e-01,  2.8171e-01, -2.7159e-01,
         -4.0015e-01, -1.0734e+00, -2.7826e-01, -4.0100e-01, -1.2201e+00,
          9.7392e-02, -1.6835e-01,  7.5455e-01,  6.6855e-02, -4.2186e-01,
          6.2902e-01, -1.0827e+00,  3.0852e-01, -5.1429e-01, -1.2302e+00,
          1.0909e+00,  3.5780e-01, -2.7137e-01,  5.3769e-01, -1.0116e-03,
         -7.5951e-01,  1.8685e+00,  3.9877e-01,  7.6415e-01, -7.7065e-01,
          1.3953e+00,  6.0011e-01, -3.0449e-01,  1.9635e-03, -6.9140e-02,
         -1.4361e+00, -1.3440e+00, -1.0344e+00, -7.8449e-01,  8.2592e-01,
          3.4617e-01,  1.2284e+00, -3.5351e-01, -9.8325e-02,  1.0192e+00,
         -1.1404e+00,  1.6678e+00,  2.4214e-01,  2.1479e-01, -9.9777e-01,
          1.0095e+00,  2.4074e-01,  1.5371e+00, -1.5479e-01,  6.8011e-03,
          2.3626e+00,  5.7298e-01,  4.5994e-01]], device='cuda:0',
       requires_grad=True)
tensor([ 75,  64, 197])
tensor([ 75,  64, 197])
Batch prediction time: 159.1s
labels_pred_cpu SHAPE (1, 1, 75, 64, 197)
labels_gt_cpu SHAPE (1, 1, 75, 64, 197)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 0.6176953124999898, Volume error (%): 0.24427315166648167
Eccentricity (pred): 0.974692407556824, Eccentricity (GT): 0.9744928104169884
Curvature (pred): 4.942829089477844, Curvature (GT): 4.902899906677988
Batch ASD: 0.4131, HSD: 9.5020, HSD95: 1.9004, DSC: 0.9566, err_vol_cm_3: 0.6177, err_vol_percent: 0.2443, Eccentricity (pred): 0.9747, Eccentricity (GT): 0.9745, Curvature (pred): 4.9428, Curvature (GT): 4.9029
Shape of labels_lr: torch.Size([1, 75, 64, 197])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 74,  63, 194],
        [ 74,  63, 195],
        [ 74,  63, 196]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 14/16
Batch cases: ['sujet9_RF_faible']
Step 0100/1500: loss 0.1095 DSC 0.923 L2^2(z): 20.83 (10.3s)
Step 0200/1500: loss 0.0894 DSC 0.936 L2^2(z): 23.33 (10.3s)
Step 0300/1500: loss 0.0810 DSC 0.943 L2^2(z): 26.85 (10.3s)
Step 0400/1500: loss 0.0757 DSC 0.947 L2^2(z): 30.71 (10.3s)
Step 0500/1500: loss 0.0722 DSC 0.950 L2^2(z): 34.11 (10.3s)
Step 0600/1500: loss 0.0696 DSC 0.951 L2^2(z): 37.42 (10.3s)
Step 0700/1500: loss 0.0672 DSC 0.954 L2^2(z): 40.88 (10.4s)
Step 0800/1500: loss 0.0653 DSC 0.955 L2^2(z): 44.50 (10.4s)
Step 0900/1500: loss 0.0638 DSC 0.957 L2^2(z): 47.63 (10.4s)
Step 1000/1500: loss 0.0627 DSC 0.958 L2^2(z): 50.48 (10.4s)
Step 1100/1500: loss 0.0618 DSC 0.959 L2^2(z): 53.19 (10.4s)
Step 1200/1500: loss 0.0612 DSC 0.960 L2^2(z): 55.54 (10.4s)
Step 1300/1500: loss 0.0606 DSC 0.961 L2^2(z): 57.70 (10.4s)
Step 1400/1500: loss 0.0602 DSC 0.961 L2^2(z): 59.61 (10.4s)
Step 1500/1500: loss 0.0599 DSC 0.961 L2^2(z): 61.43 (10.4s)
L2^2(z): 61.4302
z: Parameter containing:
tensor([[ 1.0065e+00,  2.4486e-01,  7.7651e-02, -3.3086e-01,  2.3686e-01,
         -1.0571e+00,  1.2961e-01, -1.0801e+00,  1.0454e+00,  3.1619e-01,
          8.5732e-01,  3.5085e-01,  2.3032e-01,  7.5521e-02, -1.0446e+00,
         -1.6355e+00, -1.6708e-02,  8.2966e-01, -2.6049e-01, -3.4556e-02,
          1.6124e+00,  1.2149e-03, -8.2211e-01,  4.5889e-01, -7.7740e-01,
          6.4369e-01, -1.0187e+00,  2.6310e-01, -5.9196e-01, -1.2486e-01,
         -1.9455e-01, -1.3431e-01,  2.9547e-02,  3.2897e-01, -5.9831e-01,
          1.0381e-01,  6.0121e-01, -5.0759e-01,  3.3536e-02,  4.3241e-03,
         -9.6525e-01,  1.7947e-01,  1.2015e+00, -1.7887e-01,  5.2729e-01,
         -5.0869e-01,  3.9208e-01,  5.2611e-01, -6.0021e-01, -6.3266e-01,
          1.5385e+00, -3.2313e-01, -5.4247e-01, -3.6593e-01, -5.7841e-01,
         -1.1644e-01,  2.1025e-02,  4.2320e-01,  1.0676e+00, -8.2238e-01,
         -2.5985e-01,  6.2581e-01, -3.0939e-01,  6.5980e-01, -1.0275e+00,
         -6.1690e-01,  1.4360e+00,  6.4157e-01, -2.9351e-01,  2.0597e-01,
         -4.7525e-02, -7.2970e-01, -8.6959e-01, -1.7641e-01, -1.7220e+00,
          4.3984e-01, -1.2389e-01, -2.6110e-01,  1.2316e-01,  2.2154e-01,
         -1.4181e-01, -5.8372e-01,  2.4552e+00,  1.1350e-01, -3.9298e-01,
          5.8296e-01, -2.4588e-01, -6.2631e-01, -1.1397e+00,  4.0870e-01,
         -2.3897e-01,  2.7102e-01,  3.7184e-02, -1.1853e+00,  4.5488e-01,
         -1.3011e-01,  6.5172e-01, -1.0150e+00,  7.2762e-01, -8.5621e-01,
         -1.5098e-01,  8.2400e-01,  2.8114e-02,  8.8368e-01, -7.1414e-01,
          1.2435e+00, -4.0990e-01, -2.4582e-01,  9.0017e-02,  3.1313e-01,
          9.4627e-01, -4.7263e-02, -5.1223e-02, -2.7830e-01,  5.5584e-01,
         -4.9142e-01, -1.0237e+00, -6.3663e-01, -2.9080e-01, -4.7064e-01,
         -1.0110e+00, -6.1685e-01,  3.3737e-02, -5.4343e-02,  4.7582e-01,
         -1.1790e+00,  9.5223e-01,  8.1617e-01]], device='cuda:0',
       requires_grad=True)
tensor([ 68,  63, 215])
tensor([ 68,  63, 215])
Batch prediction time: 155.3s
labels_pred_cpu SHAPE (1, 1, 68, 63, 215)
labels_gt_cpu SHAPE (1, 1, 68, 63, 215)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 1.4988320312500036, Volume error (%): 0.7010747994980648
Eccentricity (pred): 0.974103467442745, Eccentricity (GT): 0.9742880577872957
Curvature (pred): 4.7543358858356735, Curvature (GT): 4.71829435693356
Batch ASD: 0.3046, HSD: 4.4086, HSD95: 1.7998, DSC: 0.9615, err_vol_cm_3: 1.4988, err_vol_percent: 0.7011, Eccentricity (pred): 0.9741, Eccentricity (GT): 0.9743, Curvature (pred): 4.7543, Curvature (GT): 4.7183
Shape of labels_lr: torch.Size([1, 68, 63, 215])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 67,  62, 212],
        [ 67,  62, 213],
        [ 67,  62, 214]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 15/16
Batch cases: ['sujet9_RF_fort']
Step 0100/1500: loss 0.1268 DSC 0.915 L2^2(z): 19.96 (10.7s)
Step 0200/1500: loss 0.1023 DSC 0.931 L2^2(z): 23.80 (10.7s)
Step 0300/1500: loss 0.0921 DSC 0.938 L2^2(z): 26.36 (10.7s)
Step 0400/1500: loss 0.0854 DSC 0.942 L2^2(z): 29.31 (10.7s)
Step 0500/1500: loss 0.0799 DSC 0.946 L2^2(z): 32.82 (10.7s)
Step 0600/1500: loss 0.0758 DSC 0.950 L2^2(z): 35.96 (10.7s)
Step 0700/1500: loss 0.0730 DSC 0.952 L2^2(z): 38.64 (10.7s)
Step 0800/1500: loss 0.0709 DSC 0.953 L2^2(z): 41.22 (10.7s)
Step 0900/1500: loss 0.0691 DSC 0.955 L2^2(z): 43.84 (10.7s)
Step 1000/1500: loss 0.0678 DSC 0.956 L2^2(z): 46.40 (10.7s)
Step 1100/1500: loss 0.0667 DSC 0.957 L2^2(z): 48.87 (10.7s)
Step 1200/1500: loss 0.0657 DSC 0.958 L2^2(z): 51.33 (10.7s)
Step 1300/1500: loss 0.0649 DSC 0.958 L2^2(z): 53.86 (10.7s)
Step 1400/1500: loss 0.0640 DSC 0.959 L2^2(z): 56.54 (10.7s)
Step 1500/1500: loss 0.0633 DSC 0.960 L2^2(z): 59.08 (10.7s)
L2^2(z): 59.0844
z: Parameter containing:
tensor([[-1.1595e+00,  3.0027e-01,  1.3902e-01, -4.2175e-01,  6.5177e-02,
         -1.0168e+00,  3.2299e-02, -9.3832e-01,  5.8653e-01,  2.8965e-01,
          4.9325e-01,  8.8065e-01, -2.5589e-01,  3.8865e-01, -1.1471e+00,
         -2.8363e-01,  5.6810e-01,  8.8347e-01,  3.4670e-01, -3.2861e-02,
         -9.3413e-04, -1.3945e+00, -6.6177e-01,  1.5172e+00, -6.2822e-01,
         -3.2253e-02, -4.8809e-01, -1.1607e+00,  3.9041e-01, -1.5555e-01,
          4.2441e-01, -8.9608e-01,  5.4437e-01,  4.7561e-01, -4.5163e-01,
          3.5076e-01, -3.7234e-02,  8.3509e-03, -4.2621e-01,  1.0021e+00,
          5.0991e-02,  4.2355e-01,  9.9753e-01,  6.8589e-01, -1.3001e-01,
         -6.1440e-01,  5.1313e-01,  1.1480e+00, -3.4606e-01,  1.1859e-01,
         -2.8903e-01,  1.2193e+00, -4.5467e-02, -9.3655e-01, -5.9946e-02,
          1.1375e+00, -1.8968e-01,  6.4726e-02,  5.2532e-01, -9.7894e-01,
         -2.9050e-01, -5.7928e-01, -4.8854e-01,  7.1350e-01, -2.7879e-01,
         -2.7128e-01,  1.4048e+00,  2.7275e-01, -1.0842e+00,  1.2899e+00,
          2.4378e-01, -2.1784e-01, -6.2028e-01, -6.0398e-01,  1.4609e-01,
          9.1148e-02,  5.5828e-01,  3.2203e-01, -7.6036e-01, -1.7400e-01,
         -4.2327e-01, -8.1838e-01,  1.4445e+00,  1.6368e-01, -5.0219e-01,
          1.5131e+00, -1.1918e+00, -9.6638e-02, -1.1708e+00,  3.2733e-01,
          8.2884e-01,  8.7715e-02, -5.1008e-01, -6.1135e-01,  3.7870e-01,
          7.0825e-02,  1.2731e+00, -4.0546e-01,  6.5724e-01, -7.0679e-02,
          4.4467e-01,  1.0678e+00,  4.0765e-02, -2.8953e-01, -6.8365e-01,
          2.4694e-02, -8.2559e-01, -2.3520e-01,  1.8543e-01,  6.7207e-01,
          5.7009e-01,  6.2425e-01,  1.5439e+00, -9.9153e-01, -1.4679e-01,
         -1.5183e-01, -3.5773e-01, -2.1648e-01, -4.7275e-01, -7.5182e-01,
          5.5078e-02, -3.2279e-01,  6.3068e-01,  9.5820e-01,  7.3841e-01,
         -9.9451e-01,  7.0717e-01,  8.4834e-01]], device='cuda:0',
       requires_grad=True)
tensor([ 65,  63, 232])
tensor([ 65,  63, 232])
Batch prediction time: 160.2s
labels_pred_cpu SHAPE (1, 1, 65, 63, 232)
labels_gt_cpu SHAPE (1, 1, 65, 63, 232)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 1.12532031249998, Volume error (%): 0.5233926816446779
Eccentricity (pred): 0.972943476949651, Eccentricity (GT): 0.9728416498310803
Curvature (pred): 4.816401572296394, Curvature (GT): 4.816851236099794
Batch ASD: 0.3612, HSD: 11.1489, HSD95: 1.7002, DSC: 0.9599, err_vol_cm_3: 1.1253, err_vol_percent: 0.5234, Eccentricity (pred): 0.9729, Eccentricity (GT): 0.9728, Curvature (pred): 4.8164, Curvature (GT): 4.8169
Shape of labels_lr: torch.Size([1, 65, 63, 232])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 64,  62, 229],
        [ 64,  62, 230],
        [ 64,  62, 231]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 16/16
Batch cases: ['sujet9_RF_pad']
Step 0100/1500: loss 0.1191 DSC 0.910 L2^2(z): 22.19 (11.9s)
Step 0200/1500: loss 0.0952 DSC 0.929 L2^2(z): 25.60 (11.7s)
Step 0300/1500: loss 0.0831 DSC 0.937 L2^2(z): 30.11 (11.7s)
Step 0400/1500: loss 0.0761 DSC 0.943 L2^2(z): 34.41 (11.7s)
Step 0500/1500: loss 0.0712 DSC 0.947 L2^2(z): 38.41 (11.7s)
Step 0600/1500: loss 0.0675 DSC 0.950 L2^2(z): 42.80 (11.7s)
Step 0700/1500: loss 0.0650 DSC 0.952 L2^2(z): 46.55 (11.7s)
Step 0800/1500: loss 0.0631 DSC 0.954 L2^2(z): 50.13 (11.7s)
Step 0900/1500: loss 0.0616 DSC 0.956 L2^2(z): 53.43 (11.7s)
Step 1000/1500: loss 0.0605 DSC 0.957 L2^2(z): 56.07 (11.7s)
Step 1100/1500: loss 0.0594 DSC 0.958 L2^2(z): 57.98 (11.7s)
Step 1200/1500: loss 0.0588 DSC 0.959 L2^2(z): 59.54 (11.7s)
Step 1300/1500: loss 0.0582 DSC 0.960 L2^2(z): 61.09 (11.7s)
Step 1400/1500: loss 0.0577 DSC 0.960 L2^2(z): 62.37 (11.7s)
Step 1500/1500: loss 0.0573 DSC 0.961 L2^2(z): 63.67 (11.7s)
L2^2(z): 63.6706
z: Parameter containing:
tensor([[-1.3432, -0.1312,  0.6667, -0.8210,  0.2902, -0.8361, -0.0894, -0.8023,
          0.8472,  0.0912,  0.7801, -0.7024, -0.3900,  0.8323, -0.7585, -0.1204,
         -0.0698,  0.2547,  0.9991,  0.0229,  0.1744,  0.0664,  0.1703, -0.6715,
          0.1607,  0.8983, -0.1241,  0.0041, -0.9271, -0.6468,  1.0274, -1.0178,
          0.4050, -0.3705,  0.1603, -0.0313,  0.5976, -0.2630,  0.4498, -0.7546,
          0.2786, -0.4343,  1.2649,  0.0709, -0.2336, -0.1078,  0.4359, -0.0716,
         -0.6703, -0.3479,  0.6459,  0.4830, -0.7144,  0.2725, -0.1727,  0.2158,
          0.8017, -0.8091,  0.1269,  0.0379, -1.2435,  0.0492, -0.9826,  0.6881,
         -0.0089, -0.0614,  1.0884, -0.2967,  0.1666, -0.8005,  0.6547,  0.4682,
          0.0561,  1.4568,  0.6279,  0.1188, -0.0024,  1.8045, -0.7933,  0.9497,
         -1.4867, -0.3425,  1.9234, -0.4650,  0.0233, -0.1910,  0.3544, -0.3331,
         -1.3676, -0.8505,  0.6957,  0.3206,  0.1104, -0.8077, -0.1267,  0.0596,
          1.2163, -1.0024, -0.3076, -0.1690,  0.1176,  0.6477,  1.0869, -1.4098,
         -0.8015,  1.3979, -0.3346, -0.2955, -1.0505, -0.1294,  0.5371,  0.8121,
         -0.2486, -0.1409, -0.6048, -0.0895, -0.8934,  0.7421,  0.7585, -1.1443,
         -0.4349, -0.5384, -0.0466,  0.0258,  0.7120, -1.6283,  0.9125,  0.9260]],
       device='cuda:0', requires_grad=True)
tensor([ 72,  70, 207])
tensor([ 72,  70, 207])
Batch prediction time: 175.6s
labels_pred_cpu SHAPE (1, 1, 72, 70, 207)
labels_gt_cpu SHAPE (1, 1, 72, 70, 207)
output/DIASEM_NOT_MISMATCH/DIASEM_RF_set1_NO_MISMATCH_registered_turned_1500_eval_ax2_x1/predictions.json
Volume error (cm³): 1.1187148437500127, Volume error (%): 0.5408095554081017
Eccentricity (pred): 0.9725391485613221, Eccentricity (GT): 0.9723799780276212
Curvature (pred): 4.77693663798721, Curvature (GT): 4.774075826884851
Batch ASD: 0.3114, HSD: 4.2494, HSD95: 1.9004, DSC: 0.9608, err_vol_cm_3: 1.1187, err_vol_percent: 0.5408, Eccentricity (pred): 0.9725, Eccentricity (GT): 0.9724, Curvature (pred): 4.7769, Curvature (GT): 4.7741
Shape of labels_lr: torch.Size([1, 72, 70, 207])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 71,  69, 204],
        [ 71,  69, 205],
        [ 71,  69, 206]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))


latent_and_infos : Parameter containing:
tensor([[-1.3432, -0.1312,  0.6667, -0.8210,  0.2902, -0.8361, -0.0894, -0.8023,
          0.8472,  0.0912,  0.7801, -0.7024, -0.3900,  0.8323, -0.7585, -0.1204,
         -0.0698,  0.2547,  0.9991,  0.0229,  0.1744,  0.0664,  0.1703, -0.6715,
          0.1607,  0.8983, -0.1241,  0.0041, -0.9271, -0.6468,  1.0274, -1.0178,
          0.4050, -0.3705,  0.1603, -0.0313,  0.5976, -0.2630,  0.4498, -0.7546,
          0.2786, -0.4343,  1.2649,  0.0709, -0.2336, -0.1078,  0.4359, -0.0716,
         -0.6703, -0.3479,  0.6459,  0.4830, -0.7144,  0.2725, -0.1727,  0.2158,
          0.8017, -0.8091,  0.1269,  0.0379, -1.2435,  0.0492, -0.9826,  0.6881,
         -0.0089, -0.0614,  1.0884, -0.2967,  0.1666, -0.8005,  0.6547,  0.4682,
          0.0561,  1.4568,  0.6279,  0.1188, -0.0024,  1.8045, -0.7933,  0.9497,
         -1.4867, -0.3425,  1.9234, -0.4650,  0.0233, -0.1910,  0.3544, -0.3331,
         -1.3676, -0.8505,  0.6957,  0.3206,  0.1104, -0.8077, -0.1267,  0.0596,
          1.2163, -1.0024, -0.3076, -0.1690,  0.1176,  0.6477,  1.0869, -1.4098,
         -0.8015,  1.3979, -0.3346, -0.2955, -1.0505, -0.1294,  0.5371,  0.8121,
         -0.2486, -0.1409, -0.6048, -0.0895, -0.8934,  0.7421,  0.7585, -1.1443,
         -0.4349, -0.5384, -0.0466,  0.0258,  0.7120, -1.6283,  0.9125,  0.9260]],
       device='cuda:0', requires_grad=True)
ASD: 0.3990 +- 0.1042 in [0.2603, 0.5896]
HSD95: 1.9444 +- 0.5391 in [1.5000, 3.8008]
HSD: 8.0427 +- 3.2189 in [4.2494, 16.3478]
DSC: 0.9447 +- 0.0175 in [0.9077, 0.9648]
err_vol_cm_3: 0.9287 +- 0.7902 in [0.1769, 3.5283]
err_vol_cm_3: 0.6128 +- 0.4996 in [0.2148, 2.1087]
