Evaluating model 'DIASEM_test'.
Reconstructing from slices with step size 1 along axis 2.
Loading test data into memory...
FD121_RF
Initial spacing: [0.17 0.17 0.17]
New spacing: [1.70000002 1.70000002 1.70000002]
RESAMPLED VOL SHAPE: (65, 66, 228)
sujet12_RF_faible
Initial spacing: [0.17 0.17 0.17]
New spacing: [1.70000002 1.70000002 1.70000002]
RESAMPLED VOL SHAPE: (63, 69, 211)
SPACINGS: [tensor([1.7002, 1.7002, 1.7002], dtype=torch.float16), tensor([1.7002, 1.7002, 1.7002], dtype=torch.float16)]
Volume size: tensor([110.5000, 117.3125, 387.7500], dtype=torch.float16).
Loading test data done (2 images): 47.18s
Loading state file: models/DIASEM_test/checkpoint_9000.pth
Train latents avg length squared: 22.25234031677246
[373.0, 324.0, 1103.5]
Batch 1/2
Batch cases: ['FD121_RF']
Step 0100/0500: loss 0.4559 DSC 0.710 L2^2(z): 17.61 (11.8s)
Step 0200/0500: loss 0.3905 DSC 0.738 L2^2(z): 27.49 (10.9s)
Step 0300/0500: loss 0.3279 DSC 0.774 L2^2(z): 47.32 (10.9s)
Step 0400/0500: loss 0.2756 DSC 0.806 L2^2(z): 76.14 (10.9s)
Step 0500/0500: loss 0.2382 DSC 0.831 L2^2(z): 109.42 (10.9s)
L2^2(z): 109.42
z: Parameter containing:
tensor([[ 1.0889e+00, -9.3258e-01, -2.4582e-01, -2.9355e-01, -1.2922e+00,
          2.4894e-01, -4.8086e-01,  9.1377e-01, -1.3855e-01, -5.0875e-01,
         -1.9551e+00, -7.2557e-01,  1.4040e+00,  1.3331e-02, -5.0664e-01,
         -1.0757e+00, -5.5296e-01, -3.4096e-01,  6.2276e-02,  1.0533e+00,
         -6.8847e-01, -4.4401e-01, -1.4337e+00, -4.5569e-01,  4.1746e-01,
          4.3048e-01,  4.9771e-02,  2.8682e-01,  2.6971e-01, -2.4836e-01,
         -9.0456e-01,  1.4189e+00, -7.1900e-01,  1.4284e+00, -2.8425e-01,
         -1.2443e-01,  1.2125e+00, -1.5547e-01,  6.5707e-01,  1.1849e-01,
         -8.6826e-01, -1.7350e-01,  1.0423e+00,  4.7663e-01, -9.1082e-01,
         -4.9934e-01,  3.6793e-01,  1.1501e+00, -5.7155e-01, -3.1635e-01,
         -2.0555e-03,  9.6675e-01,  8.5924e-01, -1.3597e+00, -2.1244e-01,
         -1.2407e+00, -5.6424e-01, -5.5870e-01,  3.9182e+00, -4.7277e-01,
         -4.5598e-01, -1.6235e-01,  8.8490e-01, -2.1900e-01, -2.3836e-01,
          2.8665e+00, -5.1606e-03, -5.1784e-01, -9.4151e-01,  2.0068e-01,
          5.0043e-02, -7.0825e-02,  8.3044e-01, -8.3227e-01,  1.7313e-01,
         -2.2396e-01,  1.2234e+00, -1.2588e+00, -1.1354e-01, -2.7375e-01,
          1.7678e-01,  1.2132e+00, -1.0730e+00,  1.3675e+00, -9.9488e-01,
         -4.1249e-01,  6.9997e-01,  9.2966e-01,  6.4615e-01,  7.7918e-01,
         -3.2368e-01, -5.8400e-01,  9.9061e-01,  3.6296e+00, -6.0156e-01,
         -9.2856e-02,  5.5446e-01,  7.7375e-01, -1.7200e-01,  6.7854e-01,
          1.6021e-01, -3.6273e-01, -3.3837e-01, -4.6748e-01,  9.6116e-01,
         -2.4600e-01, -5.3673e-01,  1.5940e+00, -9.5649e-01, -2.3431e-01,
         -6.0104e-01,  8.7970e-01,  5.4092e-01, -9.1184e-02, -6.6082e-01,
          9.0608e-01, -1.5489e+00, -4.1035e-01,  2.4382e-01, -4.0410e-01,
         -1.0296e+00,  9.0745e-01,  1.4869e+00,  7.5898e-01, -4.2517e-01,
          1.8091e-01,  1.2115e+00,  9.1908e-01]], device='cuda:0',
       requires_grad=True)
Batch prediction time: 55.4s
labels_pred_cpu SHAPE (1, 1, 65, 66, 228)
labels_gt_cpu SHAPE (1, 1, 65, 66, 228)
output/DIASEM_test_500_eval_ax2_x1/predictions.json
Volume error (cm³): 1.4250781249999989, Volume error (%): 1.3600337663555775
Batch ASD: 1.46, HSD: 22.36, HSD95: 5.10, DSC: 0.83, err_vol_cm_3: 1.43, err_vol_percent: 1.36 
Shape of labels_lr: torch.Size([1, 65, 66, 228])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 64,  65, 225],
        [ 64,  65, 226],
        [ 64,  65, 227]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))
Batch 2/2
Batch cases: ['sujet12_RF_faible']
Step 0100/0500: loss 0.7066 DSC 0.661 L2^2(z): 50.19 (10.3s)
Step 0200/0500: loss 0.6260 DSC 0.691 L2^2(z): 60.48 (10.3s)
Step 0300/0500: loss 0.5418 DSC 0.723 L2^2(z): 79.40 (10.3s)
Step 0400/0500: loss 0.4562 DSC 0.757 L2^2(z): 114.85 (10.3s)
Step 0500/0500: loss 0.3809 DSC 0.789 L2^2(z): 162.69 (10.3s)
L2^2(z): 162.69
z: Parameter containing:
tensor([[-0.5592, -1.1312, -0.6008,  0.2740,  0.7297, -0.5017, -1.1874, -1.4817,
          1.3315, -0.2672, -0.2432, -0.0736,  0.4961,  2.2731, -0.6247, -0.9472,
         -0.6762, -0.9302,  1.2911,  2.3372, -1.4637, -0.9766, -0.9757, -0.9107,
          1.2000, -0.3004, -0.8224, -0.6883,  1.1142, -0.2146, -0.4902,  2.0940,
         -0.7751,  3.3844, -0.4424,  0.7558,  1.3587, -0.7599,  1.1342,  0.6306,
         -0.0284,  1.1167,  2.2644,  0.6428,  0.5823, -1.2797,  0.5131,  1.2495,
          2.2114,  0.2633,  0.4282, -0.4237,  1.0498, -2.8148,  0.6441, -1.5024,
         -0.1996,  0.5186,  2.5345, -1.1233, -2.8276,  0.7267, -1.1669, -0.5881,
         -0.7872,  1.2873,  0.5341,  0.0953, -1.1664,  1.6422,  0.3955,  0.4928,
         -0.8250, -0.8802,  0.6933, -0.1873,  1.7804,  1.3035,  0.2138,  0.0963,
          0.3709,  1.9013, -0.4413,  2.0145, -0.5650,  0.2938,  0.3753, -2.4349,
          1.3794,  1.1732,  0.3814, -0.9165,  0.6335,  1.9750, -1.8924,  0.2622,
          0.4168,  0.7795,  0.8606,  0.8138,  0.3693,  0.2680, -0.2250, -0.5986,
         -0.2064, -0.8382,  0.0313,  0.8427, -0.6092, -0.6032, -0.5018, -0.3600,
          0.5181, -0.1538, -1.2215,  0.5567,  0.7776,  0.8446, -2.0736, -0.3119,
          0.4476,  1.9089, -0.2856, -0.8916, -0.8859,  1.5688,  0.7638,  0.7898]],
       device='cuda:0', requires_grad=True)
Batch prediction time: 51.5s
labels_pred_cpu SHAPE (1, 1, 63, 69, 211)
labels_gt_cpu SHAPE (1, 1, 63, 69, 211)
output/DIASEM_test_500_eval_ax2_x1/predictions.json
Volume error (cm³): 0.8943593749999934, Volume error (%): 0.51612171397782
Batch ASD: 3.02, HSD: 42.54, HSD95: 18.78, DSC: 0.79, err_vol_cm_3: 0.89, err_vol_percent: 0.52 
Shape of labels_lr: torch.Size([1, 63, 69, 211])
Max voxel indices for each dimension: torch.return_types.max(
values=tensor([[  0,   0,   0],
        [  0,   0,   1],
        [  0,   0,   2],
        ...,
        [ 62,  68, 208],
        [ 62,  68, 209],
        [ 62,  68, 210]]),
indices=tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        ...,
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]]))


latents_batch : Parameter containing:
tensor([[-0.5592, -1.1312, -0.6008,  0.2740,  0.7297, -0.5017, -1.1874, -1.4817,
          1.3315, -0.2672, -0.2432, -0.0736,  0.4961,  2.2731, -0.6247, -0.9472,
         -0.6762, -0.9302,  1.2911,  2.3372, -1.4637, -0.9766, -0.9757, -0.9107,
          1.2000, -0.3004, -0.8224, -0.6883,  1.1142, -0.2146, -0.4902,  2.0940,
         -0.7751,  3.3844, -0.4424,  0.7558,  1.3587, -0.7599,  1.1342,  0.6306,
         -0.0284,  1.1167,  2.2644,  0.6428,  0.5823, -1.2797,  0.5131,  1.2495,
          2.2114,  0.2633,  0.4282, -0.4237,  1.0498, -2.8148,  0.6441, -1.5024,
         -0.1996,  0.5186,  2.5345, -1.1233, -2.8276,  0.7267, -1.1669, -0.5881,
         -0.7872,  1.2873,  0.5341,  0.0953, -1.1664,  1.6422,  0.3955,  0.4928,
         -0.8250, -0.8802,  0.6933, -0.1873,  1.7804,  1.3035,  0.2138,  0.0963,
          0.3709,  1.9013, -0.4413,  2.0145, -0.5650,  0.2938,  0.3753, -2.4349,
          1.3794,  1.1732,  0.3814, -0.9165,  0.6335,  1.9750, -1.8924,  0.2622,
          0.4168,  0.7795,  0.8606,  0.8138,  0.3693,  0.2680, -0.2250, -0.5986,
         -0.2064, -0.8382,  0.0313,  0.8427, -0.6092, -0.6032, -0.5018, -0.3600,
          0.5181, -0.1538, -1.2215,  0.5567,  0.7776,  0.8446, -2.0736, -0.3119,
          0.4476,  1.9089, -0.2856, -0.8916, -0.8859,  1.5688,  0.7638,  0.7898]],
       device='cuda:0', requires_grad=True)
ASD: 2.24 +- 0.78 in [1.46, 3.02]
HSD95: 11.94 +- 6.84 in [5.10, 18.78]
HSD: 32.45 +- 10.09 in [22.36, 42.54]
DSC: 0.81 +- 0.02 in [0.79, 0.83]
err_vol_cm_3: 1.16 +- 0.27 in [0.89, 1.43]
err_vol_cm_3: 0.94 +- 0.42 in [0.52, 1.36]
