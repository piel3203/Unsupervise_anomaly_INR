Evaluating model 'DIASEM_test'.
Reconstructing from slices with step size 1 along axis 2.
Loading test data into memory...
FD121_RF
Initial spacing: [0.17 0.17 0.17]
New spacing: [1.70000002 1.70000002 1.70000002]
RESAMPLED VOL SHAPE: (65, 66, 228)
sujet12_RF_faible
Initial spacing: [0.17 0.17 0.17]
New spacing: [1.70000002 1.70000002 1.70000002]
RESAMPLED VOL SHAPE: (63, 69, 211)
SPACINGS: [tensor([1.7002, 1.7002, 1.7002], dtype=torch.float16), tensor([1.7002, 1.7002, 1.7002], dtype=torch.float16)]
Volume size: tensor([110.5000, 117.3125, 387.7500], dtype=torch.float16).
Loading test data done (2 images): 47.11s
Loading state file: models/DIASEM_test/checkpoint_9000.pth
Train latents avg length squared: 22.25234031677246
[373.0, 324.0, 1103.5]
Batch 1/2
Batch cases: ['FD121_RF']
Step 0100/1500: loss 0.4559 DSC 0.710 L2^2(z): 17.61 (11.8s)
Step 0200/1500: loss 0.3905 DSC 0.738 L2^2(z): 27.49 (10.9s)
Step 0300/1500: loss 0.3279 DSC 0.774 L2^2(z): 47.32 (10.9s)
Step 0400/1500: loss 0.2757 DSC 0.806 L2^2(z): 76.14 (10.9s)
Step 0500/1500: loss 0.2382 DSC 0.831 L2^2(z): 109.42 (10.9s)
Step 0600/1500: loss 0.2164 DSC 0.847 L2^2(z): 138.46 (10.9s)
Step 0700/1500: loss 0.2002 DSC 0.859 L2^2(z): 162.46 (11.0s)
Step 0800/1500: loss 0.1875 DSC 0.869 L2^2(z): 182.70 (11.0s)
Step 0900/1500: loss 0.1777 DSC 0.878 L2^2(z): 200.67 (11.0s)
Step 1000/1500: loss 0.1713 DSC 0.884 L2^2(z): 215.82 (11.0s)
Step 1100/1500: loss 0.1664 DSC 0.888 L2^2(z): 229.54 (11.0s)
Step 1200/1500: loss 0.1621 DSC 0.892 L2^2(z): 242.79 (11.0s)
Step 1300/1500: loss 0.1586 DSC 0.896 L2^2(z): 254.69 (11.0s)
Step 1400/1500: loss 0.1558 DSC 0.899 L2^2(z): 265.39 (11.0s)
Step 1500/1500: loss 0.1535 DSC 0.902 L2^2(z): 274.49 (11.0s)
L2^2(z): 274.49
z: Parameter containing:
tensor([[ 1.2993, -0.7090, -1.0259, -1.1547, -1.5129,  0.6192,  0.0263,  0.9934,
         -1.0211, -2.2102, -3.1873, -2.2413,  0.6259,  0.6264, -0.3453, -2.4909,
         -1.4771, -1.1605,  0.9229,  2.6561, -1.8328, -0.7997, -1.8788,  0.4254,
          0.5898, -0.2104, -0.0302, -0.7387, -0.1004, -0.1836, -1.4316,  2.6402,
         -1.2798,  2.2855, -1.5523,  0.2667,  1.2371, -0.0137,  1.0144, -0.3980,
         -1.2402, -0.7620,  2.2978, -0.1235, -0.5185, -1.8097,  0.9753,  1.8150,
         -1.7311, -1.3394,  1.4432,  1.5189,  0.8518, -1.2701, -1.1736, -2.5140,
         -0.7097, -0.1791,  5.3345, -1.9654,  0.1315,  1.8017,  1.3044,  0.3909,
         -0.1648,  2.5437, -0.6694, -0.9398, -1.7038, -0.1364, -0.1863,  0.3770,
          1.0740, -2.0222,  0.0581, -0.4093,  1.9137, -0.0328, -0.7480, -0.3741,
          1.0669,  1.5221, -1.0941,  1.0182, -1.1919, -0.4401,  0.7404,  2.8156,
          0.2519,  0.8483, -1.0418, -0.6243,  1.4538,  4.9445, -1.0859, -0.1420,
          0.3547,  0.1216,  2.1970,  0.8543,  1.6002, -0.7327, -0.9564, -0.1875,
          1.7334, -1.0983, -1.8040,  2.1739, -2.4318,  0.0989, -1.2086,  1.2893,
          0.9287, -0.0455, -1.0539,  1.5672, -1.7170, -1.3199,  0.6834, -0.5549,
         -2.7127, -0.8073,  1.6706,  1.5532, -0.2038,  0.1149,  1.6212,  1.0766]],
       device='cuda:0', requires_grad=True)
Batch prediction time: 165.4s
labels_pred_cpu SHAPE (1, 1, 65, 66, 228)
labels_gt_cpu SHAPE (1, 1, 65, 66, 228)
output/DIASEM_test_1500_eval_ax2_x1/predictions.json
